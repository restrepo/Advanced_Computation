
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data Analysis &#8212; Advanced Computation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Clases" href="Intro_clases.html" />
    <link rel="prev" title="GitHub Actions for DevOps" href="DevOps.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Advanced Computation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Multiprocessing.html">
   Multiprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="DevOps.html">
   GitHub Actions for DevOps
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Intro_clases.html">
   Clases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fullstack.html">
   Full Stack development
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markdown-notebooks.html">
   Notebooks with MyST Markdown
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/restrepo/Advanced_Computation/master?urlpath=tree/docs/Data_Analysis.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/restrepo/Advanced_Computation"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/restrepo/Advanced_Computation/issues/new?title=Issue%20on%20page%20%2FData_Analysis.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/Data_Analysis.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solutions-object">
   Solutions object
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-of-entry">
     Example of entry
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-the-full-dataset">
     Read the full dataset
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-the-new-column-with-the-list-of-hidden-sectors">
     Add the new column with the list of hidden sectors
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ask-question-to-the-solutions-object">
   Ask question to the solutions object
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#appendix-same-questions-for-standard-model-sm-solutions">
     Appendix: Same questions for Standard Model (SM) solutions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extend-the-data-scheme-with-number-of-generations">
     Extend the data scheme with number of generations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix-use-merge-to-compare-two-dataframes">
   Appendix: Use merge to compare two DataFrames
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Data Analysis</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solutions-object">
   Solutions object
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-of-entry">
     Example of entry
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-the-full-dataset">
     Read the full dataset
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-the-new-column-with-the-list-of-hidden-sectors">
     Add the new column with the list of hidden sectors
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ask-question-to-the-solutions-object">
   Ask question to the solutions object
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#appendix-same-questions-for-standard-model-sm-solutions">
     Appendix: Same questions for Standard Model (SM) solutions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extend-the-data-scheme-with-number-of-generations">
     Extend the data scheme with number of generations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix-use-merge-to-compare-two-dataframes">
   Appendix: Use merge to compare two DataFrames
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="data-analysis">
<h1>Data Analysis<a class="headerlink" href="#data-analysis" title="Permalink to this headline">#</a></h1>
<div class="section" id="solutions-object">
<h2>Solutions object<a class="headerlink" href="#solutions-object" title="Permalink to this headline">#</a></h2>
<p>Obtain the Hidden Sector from: <a class="reference external" href="https://zenodo.org/record/5526707#.YzwIANJBzeQ">https://zenodo.org/record/5526707#.YzwIANJBzeQ</a> and add the missing the column <code class="docutils literal notranslate"><span class="pre">Hidden</span> <span class="pre">Sector</span></code> of the following data scheme</p>
<p><img alt="img" src="_images/squeme.svg" /></p>
<div class="section" id="example-of-entry">
<h3>Example of entry<a class="headerlink" href="#example-of-entry" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">JSON</span> 
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">JSON</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;IPython.core.display.JSON object&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">JSON</span><span class="p">(([{</span><span class="s1">&#39;l&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;k&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span>
       <span class="s1">&#39;solution&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="s1">&#39;gcd&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
      <span class="s1">&#39;hidden&#39;</span><span class="p">:[{</span><span class="s1">&#39;ψ&#39;</span><span class="p">:[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="o">-</span><span class="mi">3</span><span class="p">,)],</span>
                 <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">}</span>
               <span class="p">]</span>
             <span class="p">}]</span> 
            <span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;IPython.core.display.JSON object&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;l&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;k&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span>
       <span class="s1">&#39;solution&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="s1">&#39;gcd&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
      <span class="s1">&#39;hidden&#39;</span><span class="p">:[{</span><span class="s1">&#39;ψ&#39;</span><span class="p">:[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="o">-</span><span class="mi">3</span><span class="p">,)],</span>
                 <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">}</span>
               <span class="p">]</span>
             <span class="p">}]</span> 
            <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>hidden</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[1, 3]</td>
      <td>[2]</td>
      <td>[1, 2, -3, 4, 5]</td>
      <td>1</td>
      <td>5</td>
      <td>[{'ψ': [(1, 5), (2, 4), (-3,)], 'S': 6}]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="read-the-full-dataset">
<h3>Read the full dataset<a class="headerlink" href="#read-the-full-dataset" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;https://zenodo.org/record/5526707/files/solutions.json?download=1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FULL</span><span class="o">=</span><span class="kc">True</span>
<span class="k">if</span> <span class="n">FULL</span><span class="p">:</span>
    <span class="c1">#From https://zenodo.org/record/7380817/files/solutions.json.gz?download=1</span>
    <span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;solutions.json.gz&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">&lt;=</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 5)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">solutions</span></code> column, was generated with an ordering in absolute value, like the following</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sorted</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, -2, 5, -8]
</pre></div>
</div>
</div>
</div>
<p>This allows to take the maximum directly from the last element</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0          9
1         10
2         20
3         22
4         25
          ..
390069    32
390070    32
390071   -32
390072    32
390073    32
Name: solution, Length: 390074, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;zmax&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#How many solutions with n=12 and z_max &lt;= 20?</span>
<span class="n">df</span><span class="p">[</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">20</span><span class="p">)</span> <span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(65910, 6)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[-2]</td>
      <td>[2, 3]</td>
      <td>[1, 5, -7, -8, 9]</td>
      <td>4</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[3]</td>
      <td>[-3, -2]</td>
      <td>[2, 4, -7, -9, 10]</td>
      <td>18</td>
      <td>5</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[-2]</td>
      <td>[3, 1]</td>
      <td>[1, 14, -17, -18, 20]</td>
      <td>6</td>
      <td>5</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="add-the-new-column-with-the-list-of-hidden-sectors">
<h3>Add the new column with the list of hidden sectors<a class="headerlink" href="#add-the-new-column-with-the-list-of-hidden-sectors" title="Permalink to this headline">#</a></h3>
<p>After refactoring…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">mh</span>

<span class="k">def</span> <span class="nf">remove_double_intersection_pairs</span><span class="p">(</span><span class="n">msvp</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Example:</span>
<span class="sd">        msvp = [(3,4),(6,-13),(1,6),(-7,14),(1,-8)]</span>
<span class="sd">        l = [1, 3, 4, 6, -7, -8, -13, 14]</span>
<span class="sd">        # Remove (1,6) because is fully contained </span>
<span class="sd">        # in the intersections with (_1_,-8) and (_6_,-13)</span>
<span class="sd">        returns: </span>
<span class="sd">        [(3,4),(6,-13),(-7,14),(1,-8)]    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">msvp</span><span class="o">.</span><span class="n">copy</span><span class="p">():</span>
        <span class="n">tmp</span><span class="o">=</span><span class="n">msvp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">fltmp</span><span class="o">=</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">tmp</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])</span> 
        <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">l</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">fltmp</span><span class="p">):</span>
            <span class="n">msvp</span><span class="o">=</span><span class="n">tmp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">msvp</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">remove_double_intersection_pairs</span><span class="p">([(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">)],</span>
                                             <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">]))</span><span class="o">==</span><span class="mi">2</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">remove_double_intersection_pairs</span><span class="p">([(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">)],[</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">]))</span><span class="o">==</span><span class="mi">1</span>

<span class="k">def</span> <span class="nf">get_real_massless</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">msvp</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Example:</span>
<span class="sd">        l = [1, 3, 4, 6, -7, -8, -13, 14]</span>
<span class="sd">        msvp = [(3,4),(6,-13),(-7,14),(1,-8)]</span>
<span class="sd">        [1, 3, 4, 6, -7, -8, -13, 14] → [(3,4),(6,-13),(-7,14),(1,-8)]</span>
<span class="sd">        [1, 6, -7, -8, -13, 14] → [(6,-13),(-7,14),(1,-8)]</span>
<span class="sd">        [1, -7, -8, 14] → [(-7,14),(1,-8)]</span>
<span class="sd">        [1, -8] → [(1,-8)]</span>
<span class="sd">        [] → []</span>
<span class="sd">        </span>
<span class="sd">        returns:</span>
<span class="sd">        [] # lp    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">lp</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">msvp</span><span class="p">:</span>
        <span class="c1">#print(lp,msvp,x,y)</span>
        <span class="k">if</span> <span class="n">lp</span> <span class="ow">and</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lp</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">lp</span><span class="p">:</span>
            <span class="n">minxy</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">lp</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">lp</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">!=</span><span class="n">y</span><span class="p">:</span>
                <span class="p">[(</span><span class="n">lp</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">lp</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">minxy</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="p">[</span> <span class="n">lp</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lp</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="p">]</span> <span class="c1"># abs(2*x)==s</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># not lp</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">lp</span>

<span class="k">def</span> <span class="nf">get_hidden_fermions</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">ps</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    For a given scalar Abelian charge `s`, build the </span>
<span class="sd">    fermion non-zero determinant mass matrix from their</span>
<span class="sd">    Abelian charges in `l`, and returns the input `s` and </span>
<span class="sd">    the non-zero mass entries.</span>
<span class="sd">    Returns an empty dictionary otherwise.</span>
<span class="sd">    </span>
<span class="sd">    The list of combinations on pairs of `l` can be given in `ps`,</span>
<span class="sd">    otherwise it is internally calculated.</span>
<span class="sd">    </span>
<span class="sd">    Example:</span>
<span class="sd">        l = [1, 3, 4, 6, -7, -8, -13, 14]</span>
<span class="sd">        s = 7</span>
<span class="sd">        ps = [(3,4),(6,-13),(1,6),(-7,14),(1,-8)]</span>
<span class="sd">        # If necessary temove [1,6] because have is fully contained </span>
<span class="sd">        # in the intersections with others</span>
<span class="sd">        [1, 3, 4, 6, -7, -8, -13, 14] → [(3,4),(6,-13),(-7,14),(1,-8)]</span>
<span class="sd">        [1, 6, -7, -8, -13, 14] → [(6,-13),(-7,14),(1,-8)]</span>
<span class="sd">        [1, -7, -8, 14] → [(-7,14),(1,-8)]</span>
<span class="sd">        [1, -8] → [(1,-8)]</span>
<span class="sd">        [] → []</span>
<span class="sd">        </span>
<span class="sd">        returns:</span>
<span class="sd">        {&#39;s&#39;:7, &#39;\psi&#39;:[(3,4),(6,-13),(1,6),(-7,14),(1,-8)]}</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">sltn</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ps</span><span class="p">:</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations_with_replacement</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">msv</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ps</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="o">==</span><span class="n">s</span><span class="p">]</span>
    <span class="n">lmsv</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">msv</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
    <span class="n">massives</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">lmsv</span><span class="p">)</span>        
    <span class="n">massless</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">massives</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">massless</span><span class="p">:</span>
        <span class="c1"># ========= Quality check =======================</span>
        <span class="c1"># Check that all the elements of l can be removed</span>
        <span class="k">for</span> <span class="n">INTERSECTIONS</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">]:</span>
            <span class="n">msvp</span><span class="o">=</span><span class="n">msv</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">lp</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">INTERSECTIONS</span><span class="p">:</span>
                <span class="n">msvp</span> <span class="o">=</span> <span class="n">remove_double_intersection_pairs</span><span class="p">(</span><span class="n">msvp</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">msvp</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="n">msvp</span><span class="o">.</span><span class="n">copy</span><span class="p">()):</span>
                <span class="n">msvp</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">msvp</span><span class="p">)</span>
                <span class="n">lp</span><span class="o">=</span><span class="n">get_real_massless</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">msvp</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">lp</span><span class="p">:</span>
                    <span class="k">break</span> <span class="c1"># found real massless</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">lp</span><span class="p">:</span> <span class="c1"># double break for INTERSECTIONS</span>
                <span class="k">break</span> <span class="c1"># found real massless</span>
                    
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">lp</span><span class="p">:</span>
            <span class="n">sltn</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">s</span>
            <span class="n">sltn</span><span class="p">[</span><span class="s1">&#39;ψ&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">msv</span>
        <span class="k">return</span> <span class="n">sltn</span>
<span class="k">assert</span> <span class="n">get_hidden_fermions</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">9</span>    


<span class="k">def</span> <span class="nf">get_hidden_sector</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Extract massive pairs without massles fermions from l</span>
<span class="sd">        [1, 3, 4, 6, -7, -8, -13, 14] → [[3,4],[6,-13],[1,6],[-7,14],[1,-8]]</span>
<span class="sd">        #Remove [1,6] because is already in the pairs list</span>
<span class="sd">        [1, 3, 4, 6, -7, -8, -13, 14] → [[3,4],[6,-13],[-7,14],[1,-8]]</span>
<span class="sd">        [1, 6, -7, -8, -13, 14] → [[6,-13],[-7,14],[1,-8]]</span>
<span class="sd">        [1, -7, -8, 14] → [[-7,14],[1,-8]]</span>
<span class="sd">        [1, -8] → [[1,-8]]</span>
<span class="sd">        [] → []    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">sltns</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations_with_replacement</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">Ss</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ps</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">Ss</span><span class="p">:</span>
        <span class="n">sltn</span><span class="o">=</span><span class="n">get_hidden_fermions</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">ps</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sltn</span><span class="p">:</span>
            <span class="n">sltns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sltn</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sltns</span>

<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">6</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">6</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">6</span>
<span class="c1">#aψ1ψ1+bψ1ψ2+cψ1,ψ3 → https://www.wolframalpha.com/input?i=Rank%20{{a,b,c},{b,0,0},{c,0,0}}</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span>
<span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="c1">#aψ1ψ2+bψ1ψ3 → https://www.wolframalpha.com/input?i=rank+{{0,a,b},{a,0,0},{b,0,0}}</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([])</span><span class="o">==</span><span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">(</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="c1"># Ana test</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span> <span class="c1"># Dirac triplet [-10,5,15] (s=5)</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span> <span class="c1">#order of pairs matters</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="c1">#double intersection pair</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">8</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">yukawa</span> <span class="kn">import</span> <span class="n">yukawa</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_hidden_fermions</span><span class="o">=</span><span class="n">yukawa</span><span class="o">.</span><span class="n">get_massive_fermions</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">mh</span>

<span class="k">assert</span> <span class="n">get_hidden_fermions</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">9</span>    

<span class="k">def</span> <span class="nf">get_hidden_sector</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Extract massive pairs without massles fermions from l</span>
<span class="sd">        [1, 3, 4, 6, -7, -8, -13, 14] → [[3,4],[6,-13],[1,6],[-7,14],[1,-8]]</span>
<span class="sd">        #Remove [1,6] because is already in the pairs list</span>
<span class="sd">        [1, 3, 4, 6, -7, -8, -13, 14] → [[3,4],[6,-13],[-7,14],[1,-8]]</span>
<span class="sd">        [1, 6, -7, -8, -13, 14] → [[6,-13],[-7,14],[1,-8]]</span>
<span class="sd">        [1, -7, -8, 14] → [[-7,14],[1,-8]]</span>
<span class="sd">        [1, -8] → [[1,-8]]</span>
<span class="sd">        [] → []    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">sltns</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations_with_replacement</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">Ss</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ps</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">Ss</span><span class="p">:</span>
        <span class="n">sltn</span><span class="o">=</span><span class="n">get_hidden_fermions</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">ps</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sltn</span><span class="p">:</span>
            <span class="n">sltns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sltn</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sltns</span>

<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">6</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">6</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">6</span>
<span class="c1">#aψ1ψ1+bψ1ψ2+cψ1,ψ3 → https://www.wolframalpha.com/input?i=Rank%20{{a,b,c},{b,0,0},{c,0,0}}</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span>
<span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="c1">#aψ1ψ2+bψ1ψ3 → https://www.wolframalpha.com/input?i=rank+{{0,a,b},{a,0,0},{b,0,0}}</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([])</span><span class="o">==</span><span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">(</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="c1"># Ana test</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span> <span class="c1"># Dirac triplet [-10,5,15] (s=5)</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">])</span><span class="o">==</span><span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span> <span class="c1">#order of pairs matters</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="c1">#double intersection pair</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">8</span>
<span class="k">assert</span> <span class="n">get_hidden_sector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_hidden_sector</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 28.4 s, sys: 0 ns, total: 28.4 s
Wall time: 28.4 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="c1">#.iloc[0].to_dict()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="o">.</span><span class="n">shape</span> <span class="c1">#9466 solutions with hidden sector</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5196, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="o">.</span><span class="n">zmax</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[-1, -5, -3]</td>
      <td>[-6, -4, -7]</td>
      <td>[1, 1, 2, 3, -4, -4, -5, 6]</td>
      <td>1</td>
      <td>8</td>
      <td>6</td>
      <td>[{'S': 2, 'ψ': [(3, -5), (2, -4), (-4, 6), (1,...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="ask-question-to-the-solutions-object">
<h2>Ask question to the solutions object<a class="headerlink" href="#ask-question-to-the-solutions-object" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Test the solution</p></li>
<li><p>Which is the minimum hidden sector and with the least charge in absolute value</p></li>
<li><p>Check for multigenerational solution</p></li>
<li><p>Check for unconditional stability</p></li>
<li><p>Solutions with active symmetry</p></li>
<li><p>How many solutions with n=12 and zmax&lt;=20</p></li>
<li><p>Check for Majorana and Dirac fermions</p></li>
</ul>
<p>Which <code class="docutils literal notranslate"><span class="pre">n</span></code> are allowed?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 8, 12])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>What is the minimum n?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8
</pre></div>
</div>
</div>
</div>
<p>What is the minimum <code class="docutils literal notranslate"><span class="pre">z_max</span></code>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[-1, -5, -3]</td>
      <td>[-6, -4, -7]</td>
      <td>[1, 1, 2, 3, -4, -4, -5, 6]</td>
      <td>1</td>
      <td>8</td>
      <td>6</td>
      <td>[{'S': 2, 'ψ': [(3, -5), (2, -4), (-4, 6), (1, 1)]}]</td>
    </tr>
    <tr>
      <th>1773</th>
      <td>[-1, 0, -1, 0, 1]</td>
      <td>[-3, -2, -3, -2, 2]</td>
      <td>[1, -2, -2, -2, 3, 3, 4, 4, -5, -5, -5, 6]</td>
      <td>1</td>
      <td>12</td>
      <td>6</td>
      <td>[{'S': 1, 'ψ': [(-5, 6), (-2, 3), (4, -5), (1, -2)]}, {'S': 7, 'ψ': [(3, 4), (1, 6), (-2, -5)]}]</td>
    </tr>
    <tr>
      <th>1774</th>
      <td>[2, 1, -1, 3, -1]</td>
      <td>[-3, -1, 0, -2, -3]</td>
      <td>[1, 1, 1, 1, -2, -2, -2, 3, 3, -5, -5, 6]</td>
      <td>1</td>
      <td>12</td>
      <td>6</td>
      <td>[{'S': 4, 'ψ': [(-2, -2), (1, -5), (-2, 6), (1, 3)]}]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>How many solutions have several dark sectors?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1271, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="s1">&#39;ψ&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0                                           [(3, -5), (2, -4), (-4, 6), (1, 1)]
1                                           [(2, 2), (-3, 7), (1, -5), (2, -6)]
2                                                    [(4, 5), (1, 8), (-2, -7)]
3                                           [(4, -7), (-5, 8), (2, -5), (1, 2)]
4                                 [(-6, 7), (7, -8), (5, -6), (2, -3), (-4, 5)]
                                         ...                                   
9461                         [(4, -19), (3, -18), (-13, 28), (17, -32), (6, 9)]
9462    [(-9, 27), (-6, -12), (1, -19), (4, 14), (-9, -9), (14, -32), (-8, 26)]
9463              [(-4, -5), (18, -27), (3, 6), (-5, 14), (-23, 32), (14, -23)]
9464                      [(12, -27), (4, -19), (-13, 28), (17, -32), (-9, 24)]
9465                [(6, 18), (5, 19), (-4, -20), (3, -27), (2, -26), (-8, 32)]
Name: hidden, Length: 9466, dtype: object
</pre></div>
</div>
</div>
</div>
<p>What is the minimum number of DM particles?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="s1">&#39;ψ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<p>What is the minimum number of DM particles?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="s1">&#39;ψ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1773</span><span class="p">]][</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1773    {&#39;S&#39;: 7, &#39;ψ&#39;: [(3, 4), (1, 6), (-2, -5)]}
Name: hidden, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1773</span><span class="p">]][</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1773    {&#39;S&#39;: 1, &#39;ψ&#39;: [(-5, 6), (-2, 3), (4, -5), (1, -2)]}
Name: hidden, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[(</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="s1">&#39;ψ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(221, 7)
</pre></div>
</div>
</div>
</div>
<p>to capture the cases with until with two dark sectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[(</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="s1">&#39;ψ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">|</span> 
   <span class="p">(</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="s1">&#39;ψ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>[-1, 0, 1]</td>
      <td>[-4, -2, 2]</td>
      <td>[1, -2, -2, 4, 5, -7, -7, 8]</td>
      <td>1</td>
      <td>8</td>
      <td>8</td>
      <td>[{'S': 9, 'ψ': [(4, 5), (1, 8), (-2, -7)]}]</td>
    </tr>
    <tr>
      <th>7</th>
      <td>[2, 0, -1]</td>
      <td>[-8, -5, 9]</td>
      <td>[2, -3, -3, 5, 6, -8, -8, 9]</td>
      <td>1</td>
      <td>8</td>
      <td>9</td>
      <td>[{'S': 11, 'ψ': [(5, 6), (-3, -8), (2, 9)]}]</td>
    </tr>
    <tr>
      <th>9</th>
      <td>[0, -3, -1]</td>
      <td>[-3, -5, -6, -4]</td>
      <td>[3, -4, -6, -6, 7, 7, 8, -9]</td>
      <td>1</td>
      <td>8</td>
      <td>9</td>
      <td>[{'S': 1, 'ψ': [(8, -9), (-6, 7), (3, -4)]}]</td>
    </tr>
    <tr>
      <th>11</th>
      <td>[-1, 0, -1]</td>
      <td>[-2, 1, -1]</td>
      <td>[2, -5, -5, -5, 7, 8, 8, -10]</td>
      <td>1</td>
      <td>8</td>
      <td>10</td>
      <td>[{'S': 3, 'ψ': [(7, -10), (-5, 8), (2, -5)]}]</td>
    </tr>
    <tr>
      <th>14</th>
      <td>[-3, -5, 1]</td>
      <td>[-6, -4, -5]</td>
      <td>[3, -4, -4, 6, 7, -9, -9, 10]</td>
      <td>1</td>
      <td>8</td>
      <td>10</td>
      <td>[{'S': 13, 'ψ': [(3, 10), (-4, -9), (6, 7)]}]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7956</th>
      <td>[1, -2, 1, 0, 1]</td>
      <td>[-2, -1, -2, -1, -2]</td>
      <td>[1, 1, -2, -2, -16, -16, -16, 17, 17, 17, 28, -29]</td>
      <td>1</td>
      <td>12</td>
      <td>29</td>
      <td>[{'S': 1, 'ψ': [(-16, 17), (28, -29), (1, -2)]}]</td>
    </tr>
    <tr>
      <th>7959</th>
      <td>[-2, 1, -2, 0, 2]</td>
      <td>[-2, 1, -2, 1, -1]</td>
      <td>[4, -8, -8, -8, 11, 11, 22, 22, -25, -25, -25, 29]</td>
      <td>3</td>
      <td>12</td>
      <td>29</td>
      <td>[{'S': 33, 'ψ': [(4, 29), (11, 22), (-8, -25)]}]</td>
    </tr>
    <tr>
      <th>7991</th>
      <td>[-1, 0, -2, 0, -2]</td>
      <td>[-3, 1, -3, 1, -3]</td>
      <td>[7, 7, -9, -9, -9, 17, 19, -27, -27, -27, 29, 29]</td>
      <td>4</td>
      <td>12</td>
      <td>29</td>
      <td>[{'S': 36, 'ψ': [(7, 29), (-9, -27), (17, 19)]}]</td>
    </tr>
    <tr>
      <th>7997</th>
      <td>[-2, 0, -2, 0, -2]</td>
      <td>[-3, 2, -3, 3, -3]</td>
      <td>[16, 16, -19, -19, -19, -21, -21, 24, 24, 24, 24, -29]</td>
      <td>8</td>
      <td>12</td>
      <td>29</td>
      <td>[{'S': 5, 'ψ': [(-19, 24), (24, -29), (16, -21)]}]</td>
    </tr>
    <tr>
      <th>9242</th>
      <td>[2, 0, 1, 0, 2]</td>
      <td>[-3, -2, -3, -2, -3]</td>
      <td>[2, 7, 18, 18, 18, -23, -23, -27, -27, -27, 32, 32]</td>
      <td>1</td>
      <td>12</td>
      <td>32</td>
      <td>[{'S': 9, 'ψ': [(18, -27), (2, 7), (-23, 32)]}]</td>
    </tr>
  </tbody>
</table>
<p>233 rows × 7 columns</p>
</div></div></div>
</div>
<p>What is the maximum number of DM particles?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="s1">&#39;ψ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
</div>
</div>
<p>What is the maximum number of DM particles?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="s1">&#39;ψ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[(</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="s1">&#39;ψ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">==</span><span class="mi">9</span><span class="p">)][:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019</th>
      <td>[-1, 0, -1, -2, -1]</td>
      <td>[-3, -2, 2, 1, -1]</td>
      <td>[1, 1, 2, 3, -5, -6, -6, -7, 9, 10, 11, -13]</td>
      <td>2</td>
      <td>12</td>
      <td>13</td>
      <td>[{'S': 4, 'ψ': [(9, -13), (-5, 9), (-6, 10), (2, 2), (1, 3), (-7, 11), (3, -7), (1, -5), (2, -6)]}, {'S': 12, 'ψ': [(-5, -7), (3, 9), (-6, -6), (1, -13), (1, 11), (2, 10)]}]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>What is the minimum number of <em>independent</em> DM particles?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lst</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ψ&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">17</span><span class="p">)]}]</span>
<span class="k">def</span> <span class="nf">intersections</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">lstc</span><span class="o">=</span><span class="n">lst</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">lenmax</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ψ&#39;</span><span class="p">):</span>
            <span class="n">dd</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ψ&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">dd</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="p">[</span><span class="n">dd</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">dd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">q</span><span class="p">))]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">lenmax</span><span class="p">:</span>
                <span class="n">ddd</span><span class="o">=</span><span class="n">dd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">lenmax</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
                
            <span class="k">if</span> <span class="n">mask</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">dd</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">mask</span><span class="p">:</span>        
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">ddd</span>

<span class="k">assert</span> <span class="n">intersections</span><span class="p">([{</span><span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ψ&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">17</span><span class="p">)]}])</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">intersections</span><span class="p">([{</span><span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ψ&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)]}])</span>
</pre></div>
</div>
</div>
</div>
<p>One excluded:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">intersections</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>The minimum is…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;~intersections&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">lst</span><span class="p">:</span> <span class="n">intersections</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">hs</span><span class="p">[</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;~intersections&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">==</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;~intersections&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
      <th>~intersections</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>[1, 2, 1]</td>
      <td>[-5, -10, -11]</td>
      <td>[1, 2, 2, 4, -5, -5, -7, 8]</td>
      <td>1</td>
      <td>8</td>
      <td>8</td>
      <td>[{'S': 3, 'ψ': [(4, -7), (-5, 8), (2, -5), (1, 2)]}]</td>
      <td>[(4, -7)]</td>
    </tr>
    <tr>
      <th>1121</th>
      <td>[0, -1, -2]</td>
      <td>[-1, -4, -1, 1]</td>
      <td>[4, 4, 11, 11, -14, -19, -26, 29]</td>
      <td>1</td>
      <td>8</td>
      <td>29</td>
      <td>[{'S': 15, 'ψ': [(4, -19), (11, -26), (4, 11), (-14, 29)]}]</td>
      <td>[(-14, 29)]</td>
    </tr>
    <tr>
      <th>950</th>
      <td>[-1, 0, -1]</td>
      <td>[-4, 1, -1]</td>
      <td>[7, 7, 7, 8, -13, -22, -22, 28]</td>
      <td>1</td>
      <td>8</td>
      <td>28</td>
      <td>[{'S': 15, 'ψ': [(7, -22), (-13, 28), (7, 8)]}]</td>
      <td>[(-13, 28)]</td>
    </tr>
    <tr>
      <th>937</th>
      <td>[-6, -5, -1]</td>
      <td>[-6, -8, -6]</td>
      <td>[8, -15, -15, -15, 20, 22, 22, -27]</td>
      <td>4</td>
      <td>8</td>
      <td>27</td>
      <td>[{'S': 7, 'ψ': [(8, -15), (20, -27), (-15, 22)]}]</td>
      <td>[(20, -27)]</td>
    </tr>
    <tr>
      <th>843</th>
      <td>[-2, 0, -2]</td>
      <td>[-3, 2, -2]</td>
      <td>[13, -18, -18, -18, 22, 23, 23, -27]</td>
      <td>4</td>
      <td>8</td>
      <td>27</td>
      <td>[{'S': 5, 'ψ': [(22, -27), (13, -18), (-18, 23)]}]</td>
      <td>[(22, -27)]</td>
    </tr>
    <tr>
      <th>833</th>
      <td>[1, 0, -1]</td>
      <td>[-9, -7, 7]</td>
      <td>[3, -11, -13, -13, 19, 21, 21, -27]</td>
      <td>2</td>
      <td>8</td>
      <td>27</td>
      <td>[{'S': 8, 'ψ': [(-11, 19), (-13, 21), (19, -27), (3, -11)]}]</td>
      <td>[(-13, 21)]</td>
    </tr>
    <tr>
      <th>832</th>
      <td>[-1, 0, -1]</td>
      <td>[-9, 1, -1]</td>
      <td>[3, 3, 3, -7, 17, -23, -23, 27]</td>
      <td>4</td>
      <td>8</td>
      <td>27</td>
      <td>[{'S': 20, 'ψ': [(3, 17), (-7, 27), (3, -23)]}]</td>
      <td>[(-7, 27)]</td>
    </tr>
    <tr>
      <th>799</th>
      <td>[6, 4, 6]</td>
      <td>[-6, -7, -1, 0]</td>
      <td>[9, -14, -16, -16, 21, 21, 21, -26]</td>
      <td>4</td>
      <td>8</td>
      <td>26</td>
      <td>[{'S': 5, 'ψ': [(-16, 21), (21, -26), (9, -14)]}]</td>
      <td>[(9, -14)]</td>
    </tr>
    <tr>
      <th>744</th>
      <td>[0, -2, 0]</td>
      <td>[-2, -5, -2, 2]</td>
      <td>[2, 2, 2, -5, 19, -23, -23, 26]</td>
      <td>4</td>
      <td>8</td>
      <td>26</td>
      <td>[{'S': 21, 'ψ': [(-5, 26), (2, 19), (2, -23)]}]</td>
      <td>[(-5, 26)]</td>
    </tr>
    <tr>
      <th>461</th>
      <td>[0, -1, -2]</td>
      <td>[-1, -5, -1, 1]</td>
      <td>[5, 5, 7, 7, -11, -17, -19, 23]</td>
      <td>2</td>
      <td>8</td>
      <td>23</td>
      <td>[{'S': 12, 'ψ': [(5, 7), (-11, 23), (7, -19), (5, -17)]}]</td>
      <td>[(-11, 23)]</td>
    </tr>
    <tr>
      <th>447</th>
      <td>[-1, 0, 1]</td>
      <td>[-11, -7, 7]</td>
      <td>[1, -7, -7, 11, -13, 19, 19, -23]</td>
      <td>2</td>
      <td>8</td>
      <td>23</td>
      <td>[{'S': 12, 'ψ': [(11, -23), (1, -13), (1, 11), (-7, 19)]}]</td>
      <td>[(-7, 19)]</td>
    </tr>
    <tr>
      <th>222</th>
      <td>[-1, -2, -1]</td>
      <td>[-4, 1, -6]</td>
      <td>[4, -9, -9, -11, 14, 14, 16, -19]</td>
      <td>4</td>
      <td>8</td>
      <td>19</td>
      <td>[{'S': 5, 'ψ': [(-9, 14), (-11, 16), (14, -19), (4, -9)]}]</td>
      <td>[(-11, 16)]</td>
    </tr>
    <tr>
      <th>1684</th>
      <td>[2, -3, 2]</td>
      <td>[-2, -4, -2, 0]</td>
      <td>[17, -22, -22, -23, 27, 27, 28, -32]</td>
      <td>4</td>
      <td>8</td>
      <td>32</td>
      <td>[{'S': 5, 'ψ': [(17, -22), (27, -32), (-23, 28), (-22, 27)]}]</td>
      <td>[(-23, 28)]</td>
    </tr>
    <tr>
      <th>126</th>
      <td>[1, 0, -1]</td>
      <td>[-11, -7, 7]</td>
      <td>[1, 5, 7, 7, -11, -13, -13, 17]</td>
      <td>4</td>
      <td>8</td>
      <td>17</td>
      <td>[{'S': 6, 'ψ': [(5, -11), (-11, 17), (1, 5), (7, -13)]}]</td>
      <td>[(7, -13)]</td>
    </tr>
    <tr>
      <th>120</th>
      <td>[-1, 0, -1]</td>
      <td>[-2, 2, -2]</td>
      <td>[7, -10, -11, -11, 14, 14, 14, -17]</td>
      <td>1</td>
      <td>8</td>
      <td>17</td>
      <td>[{'S': 3, 'ψ': [(-11, 14), (7, -10), (14, -17)]}]</td>
      <td>[(7, -10)]</td>
    </tr>
    <tr>
      <th>93</th>
      <td>[0, -1, 0]</td>
      <td>[-1, -4, -1, 1]</td>
      <td>[1, 1, 1, -4, -11, 14, 14, -16]</td>
      <td>1</td>
      <td>8</td>
      <td>16</td>
      <td>[{'S': 15, 'ψ': [(1, 14), (1, -16), (-4, -11)]}]</td>
      <td>[(-4, -11)]</td>
    </tr>
    <tr>
      <th>53</th>
      <td>[0, -1, 0]</td>
      <td>[-1, -6, -9, -6]</td>
      <td>[1, -6, -6, -6, 9, 11, 11, -14]</td>
      <td>2</td>
      <td>8</td>
      <td>14</td>
      <td>[{'S': 5, 'ψ': [(-6, 11), (9, -14), (1, -6)]}]</td>
      <td>[(9, -14)]</td>
    </tr>
    <tr>
      <th>40</th>
      <td>[-1, -2, -1]</td>
      <td>[-1, 1, -2]</td>
      <td>[4, -7, -7, -8, 10, 10, 11, -13]</td>
      <td>1</td>
      <td>8</td>
      <td>13</td>
      <td>[{'S': 3, 'ψ': [(4, -7), (10, -13), (-7, 10), (-8, 11)]}]</td>
      <td>[(-8, 11)]</td>
    </tr>
    <tr>
      <th>39</th>
      <td>[-1, 0, 1]</td>
      <td>[-9, -7, 5]</td>
      <td>[1, -5, -5, -7, 9, 9, 11, -13]</td>
      <td>2</td>
      <td>8</td>
      <td>13</td>
      <td>[{'S': 4, 'ψ': [(9, -13), (-5, 9), (-7, 11), (1, -5)]}]</td>
      <td>[(-7, 11)]</td>
    </tr>
    <tr>
      <th>38</th>
      <td>[0, -1, 0]</td>
      <td>[-1, -5, -1, 1]</td>
      <td>[1, 1, 1, -5, -7, 11, 11, -13]</td>
      <td>2</td>
      <td>8</td>
      <td>13</td>
      <td>[{'S': 12, 'ψ': [(1, 11), (-5, -7), (1, -13)]}]</td>
      <td>[(-5, -7)]</td>
    </tr>
    <tr>
      <th>36</th>
      <td>[0, -1, 0]</td>
      <td>[-1, -2, 2, -2]</td>
      <td>[2, -5, -7, -7, 10, 10, 10, -13]</td>
      <td>1</td>
      <td>8</td>
      <td>13</td>
      <td>[{'S': 3, 'ψ': [(-7, 10), (10, -13), (2, -5)]}]</td>
      <td>[(2, -5)]</td>
    </tr>
    <tr>
      <th>11</th>
      <td>[-1, 0, -1]</td>
      <td>[-2, 1, -1]</td>
      <td>[2, -5, -5, -5, 7, 8, 8, -10]</td>
      <td>1</td>
      <td>8</td>
      <td>10</td>
      <td>[{'S': 3, 'ψ': [(7, -10), (-5, 8), (2, -5)]}]</td>
      <td>[(7, -10)]</td>
    </tr>
    <tr>
      <th>10</th>
      <td>[1, -3, -2]</td>
      <td>[-4, -9, -5, -3]</td>
      <td>[1, 3, 3, 3, -5, -7, -7, 9]</td>
      <td>1</td>
      <td>8</td>
      <td>9</td>
      <td>[{'S': 4, 'ψ': [(1, -5), (-5, 9), (3, -7), (1, 3)]}]</td>
      <td>[(3, -7)]</td>
    </tr>
    <tr>
      <th>196</th>
      <td>[-1, 0, -1]</td>
      <td>[-3, 3, -3]</td>
      <td>[5, -9, -11, -11, 15, 15, 15, -19]</td>
      <td>2</td>
      <td>8</td>
      <td>19</td>
      <td>[{'S': 4, 'ψ': [(-11, 15), (5, -9), (15, -19)]}]</td>
      <td>[(5, -9)]</td>
    </tr>
    <tr>
      <th>2334</th>
      <td>[-1, -2, -1, -2, -1]</td>
      <td>[-1, -3, -1, -3, -1]</td>
      <td>[1, 1, 1, -5, -5, 7, 7, -9, -9, 13, 13, -15]</td>
      <td>2</td>
      <td>12</td>
      <td>15</td>
      <td>[{'S': 8, 'ψ': [(1, -9), (7, -15), (-5, 13), (1, 7)]}, {'S': 14, 'ψ': [(-5, -9), (1, -15), (7, 7), (1, 13)]}]</td>
      <td>[(-5, 13)]</td>
    </tr>
    <tr>
      <th>2898</th>
      <td>[-3, 0, -1, 0, -1]</td>
      <td>[-3, -2, -3, -2, -3]</td>
      <td>[3, 3, -7, -7, -7, -8, -8, 12, 12, 12, 12, -17]</td>
      <td>4</td>
      <td>12</td>
      <td>17</td>
      <td>[{'S': 5, 'ψ': [(12, -17), (-7, 12), (3, -8)]}]</td>
      <td>[(3, -8)]</td>
    </tr>
    <tr>
      <th>4340</th>
      <td>[-2, 0, -2, 0, -2]</td>
      <td>[-3, 2, -3, 2, -2]</td>
      <td>[9, -14, -14, -14, -14, 16, 16, 19, 19, 19, -21, -21]</td>
      <td>8</td>
      <td>12</td>
      <td>21</td>
      <td>[{'S': 5, 'ψ': [(9, -14), (-14, 19), (16, -21)]}]</td>
      <td>[(16, -21)]</td>
    </tr>
    <tr>
      <th>7139</th>
      <td>[-1, -2, -1, -2, -1]</td>
      <td>[-1, 1, -3, 1, -3]</td>
      <td>[3, -11, -11, -17, -17, 19, 19, 19, 25, 25, -27, -27]</td>
      <td>2</td>
      <td>12</td>
      <td>27</td>
      <td>[{'S': 8, 'ψ': [(-17, 25), (-11, 19), (19, -27), (3, -11)]}]</td>
      <td>[(-17, 25)]</td>
    </tr>
    <tr>
      <th>6411</th>
      <td>[-1, 0, -1, 0, -1]</td>
      <td>[-2, 2, -2, 2, -2]</td>
      <td>[11, -14, -19, -19, -19, 22, 22, 22, 22, 22, -25, -25]</td>
      <td>1</td>
      <td>12</td>
      <td>25</td>
      <td>[{'S': 3, 'ψ': [(22, -25), (11, -14), (-19, 22)]}]</td>
      <td>[(11, -14)]</td>
    </tr>
    <tr>
      <th>6412</th>
      <td>[1, 0, -1, 0, -1]</td>
      <td>[-3, 3, -3, 3, -3]</td>
      <td>[3, -7, -17, -17, -17, 21, 21, 21, 21, 21, -25, -25]</td>
      <td>2</td>
      <td>12</td>
      <td>25</td>
      <td>[{'S': 4, 'ψ': [(21, -25), (-17, 21), (3, -7)]}]</td>
      <td>[(3, -7)]</td>
    </tr>
    <tr>
      <th>6761</th>
      <td>[2, 0, -2, 0, -2]</td>
      <td>[-3, -2, 2, -2, 2]</td>
      <td>[9, 9, -14, -14, -14, -14, -14, 19, 19, 19, 21, -26]</td>
      <td>4</td>
      <td>12</td>
      <td>26</td>
      <td>[{'S': 5, 'ψ': [(21, -26), (9, -14), (-14, 19)]}]</td>
      <td>[(21, -26)]</td>
    </tr>
    <tr>
      <th>2281</th>
      <td>[-1, 0, -1, 0, -1]</td>
      <td>[-3, 1, -3, 1, -1]</td>
      <td>[3, 5, 5, 5, 5, -7, -7, -13, -13, -13, 15, 15]</td>
      <td>2</td>
      <td>12</td>
      <td>15</td>
      <td>[{'S': 8, 'ψ': [(-7, 15), (5, -13), (3, 5)]}]</td>
      <td>[(-7, 15)]</td>
    </tr>
    <tr>
      <th>5293</th>
      <td>[1, 0, -1, 0, 1]</td>
      <td>[-3, -1, -3, 3, -3]</td>
      <td>[3, 3, 5, 5, 7, 7, 7, -15, -15, -15, -15, 23]</td>
      <td>2</td>
      <td>12</td>
      <td>23</td>
      <td>[{'S': 8, 'ψ': [(7, -15), (-15, 23), (3, 5)]}]</td>
      <td>[(3, 5)]</td>
    </tr>
    <tr>
      <th>2121</th>
      <td>[-1, -2, -1, -2, -1]</td>
      <td>[-1, 1, -2, 1, -2]</td>
      <td>[5, -8, -8, -10, -10, 11, 11, 11, 13, 13, -14, -14]</td>
      <td>2</td>
      <td>12</td>
      <td>14</td>
      <td>[{'S': 3, 'ψ': [(5, -8), (-10, 13), (11, -14), (-8, 11)]}]</td>
      <td>[(-10, 13)]</td>
    </tr>
    <tr>
      <th>1848</th>
      <td>[-1, -2, -1, 0, -1]</td>
      <td>[-1, -2, -1, 1, -1]</td>
      <td>[1, -4, -4, -4, 7, 7, 7, 7, -8, -10, -10, 11]</td>
      <td>1</td>
      <td>12</td>
      <td>11</td>
      <td>[{'S': 3, 'ψ': [(-4, 7), (1, -4), (7, -10), (-8, 11)]}]</td>
      <td>[(-8, 11)]</td>
    </tr>
    <tr>
      <th>1988</th>
      <td>[-1, 0, -1, 0, -1]</td>
      <td>[-2, 1, -2, 2, -2]</td>
      <td>[5, 5, -7, -7, -7, -8, -8, 10, 10, 10, 10, -13]</td>
      <td>2</td>
      <td>12</td>
      <td>13</td>
      <td>[{'S': 3, 'ψ': [(5, -8), (-7, 10), (10, -13)]}]</td>
      <td>[(5, -8)]</td>
    </tr>
    <tr>
      <th>1985</th>
      <td>[-2, 0, -2, 3, -2]</td>
      <td>[-3, 2, -3, 2, -3]</td>
      <td>[2, 2, 3, 3, 3, 3, 3, -7, -8, -8, -8, 12]</td>
      <td>15</td>
      <td>12</td>
      <td>12</td>
      <td>[{'S': 5, 'ψ': [(2, 3), (2, -7), (-7, 12), (3, -8)]}]</td>
      <td>[(-7, 12)]</td>
    </tr>
    <tr>
      <th>1898</th>
      <td>[-1, -2, -3, -2, -1]</td>
      <td>[-3, 1, -3, -1, -3]</td>
      <td>[1, 1, 1, 3, -5, -5, -5, -5, 7, 9, 9, -11]</td>
      <td>2</td>
      <td>12</td>
      <td>11</td>
      <td>[{'S': 4, 'ψ': [(-5, 9), (7, -11), (1, 3), (1, -5)]}, {'S': 10, 'ψ': [(3, 7), (1, 9), (-5, -5), (1, -11)]}]</td>
      <td>[(7, -11)]</td>
    </tr>
    <tr>
      <th>1849</th>
      <td>[-1, -2, -1, 0, -1]</td>
      <td>[-1, 1, -2, 1, -1]</td>
      <td>[2, 2, -4, -5, -5, -5, -5, 7, 8, 8, 8, -11]</td>
      <td>1</td>
      <td>12</td>
      <td>11</td>
      <td>[{'S': 3, 'ψ': [(-4, 7), (-5, 8), (2, -5), (8, -11)]}]</td>
      <td>[(-4, 7)]</td>
    </tr>
    <tr>
      <th>1794</th>
      <td>[1, 0, -2, 0, -2]</td>
      <td>[-3, -1, -3, -1, 1]</td>
      <td>[1, 1, 1, 1, -3, -3, -5, -5, 7, 7, 7, -9]</td>
      <td>2</td>
      <td>12</td>
      <td>9</td>
      <td>[{'S': 2, 'ψ': [(-5, 7), (7, -9), (1, 1), (1, -3)]}, {'S': 8, 'ψ': [(1, 7), (1, -9), (-3, -5)]}]</td>
      <td>[(-3, -5)]</td>
    </tr>
    <tr>
      <th>1783</th>
      <td>[-1, 0, -1, 0, -1]</td>
      <td>[-2, 1, -2, 1, -1]</td>
      <td>[1, -4, -4, -4, -4, 5, 5, 7, 7, 7, -8, -8]</td>
      <td>2</td>
      <td>12</td>
      <td>8</td>
      <td>[{'S': 3, 'ψ': [(5, -8), (1, -4), (-4, 7)]}]</td>
      <td>[(5, -8)]</td>
    </tr>
    <tr>
      <th>1781</th>
      <td>[1, 0, -3, -2, 1]</td>
      <td>[-2, -1, -2, -3, 0]</td>
      <td>[1, 2, 3, 3, 3, -4, -4, -6, -6, -6, 7, 7]</td>
      <td>1</td>
      <td>12</td>
      <td>7</td>
      <td>[{'S': 3, 'ψ': [(-4, 7), (3, -6), (1, -4), (1, 2)]}]</td>
      <td>[(3, -6)]</td>
    </tr>
    <tr>
      <th>1779</th>
      <td>[2, -1, 2, -1, 2]</td>
      <td>[-3, -2, -1, -2, -1]</td>
      <td>[2, -3, -5, -5, -5, 6, 6, 6, 6, 6, -7, -7]</td>
      <td>2</td>
      <td>12</td>
      <td>7</td>
      <td>[{'S': 1, 'ψ': [(6, -7), (2, -3), (-5, 6)]}]</td>
      <td>[(2, -3)]</td>
    </tr>
    <tr>
      <th>1776</th>
      <td>[-1, -2, -1, 0, -1]</td>
      <td>[-2, 1, -1, 1, -1]</td>
      <td>[1, 1, 1, 2, 2, 2, 2, -4, -4, -5, -5, 7]</td>
      <td>1</td>
      <td>12</td>
      <td>7</td>
      <td>[{'S': 3, 'ψ': [(1, -4), (1, 2), (-4, 7), (2, -5)]}]</td>
      <td>[(2, -5)]</td>
    </tr>
    <tr>
      <th>7955</th>
      <td>[-1, 0, -1, 0, -1]</td>
      <td>[-3, 1, -3, 3, -3]</td>
      <td>[7, 7, -13, -13, -13, -15, -15, 21, 21, 21, 21, -29]</td>
      <td>2</td>
      <td>12</td>
      <td>29</td>
      <td>[{'S': 8, 'ψ': [(-13, 21), (21, -29), (7, -15)]}]</td>
      <td>[(7, -15)]</td>
    </tr>
    <tr>
      <th>2105</th>
      <td>[-1, 0, -1, 0, -1]</td>
      <td>[-2, 1, -1, 1, -1]</td>
      <td>[4, 4, -7, -7, -7, -7, -7, 10, 10, 10, 11, -14]</td>
      <td>1</td>
      <td>12</td>
      <td>14</td>
      <td>[{'S': 3, 'ψ': [(4, -7), (-7, 10), (11, -14)]}]</td>
      <td>[(11, -14)]</td>
    </tr>
    <tr>
      <th>7997</th>
      <td>[-2, 0, -2, 0, -2]</td>
      <td>[-3, 2, -3, 3, -3]</td>
      <td>[16, 16, -19, -19, -19, -21, -21, 24, 24, 24, 24, -29]</td>
      <td>8</td>
      <td>12</td>
      <td>29</td>
      <td>[{'S': 5, 'ψ': [(-19, 24), (24, -29), (16, -21)]}]</td>
      <td>[(16, -21)]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="appendix-same-questions-for-standard-model-sm-solutions">
<h3>Appendix: Same questions for Standard Model (SM) solutions<a class="headerlink" href="#appendix-same-questions-for-standard-model-sm-solutions" title="Permalink to this headline">#</a></h3>
<p>Which are solutions with three repeated integers to be asigned to SM particles</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="mi">3</span> <span class="ow">in</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">l</span><span class="p">])]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Remove the three repeated integers from the new <code class="docutils literal notranslate"><span class="pre">hidden</span></code> column</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_dark</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="c1">#TODO,</span>
    <span class="n">xxx</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">l</span> <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">]))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xxx</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">xx</span><span class="o">=</span><span class="n">xxx</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">l</span> <span class="k">if</span> <span class="n">x</span><span class="o">!=</span><span class="n">xx</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
<span class="k">assert</span> <span class="n">get_dark</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="p">)</span><span class="o">==</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">get_dark</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">==</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_dark</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_hidden_sector</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="o">=</span><span class="n">df3</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hs3</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(49, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># idxmax==1</span>
<span class="n">df3</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">get_dark</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">idx</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_hidden_sector</span><span class="p">)</span>
<span class="n">hs3</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">hs3</span><span class="p">,</span><span class="n">df3</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hs3</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(51, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># idxmax==1</span>
<span class="n">df3</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">get_dark</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">idx</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_hidden_sector</span><span class="p">)</span>
<span class="n">hs3</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">hs3</span><span class="p">,</span><span class="n">df3</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hs3</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(51, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[-3, -1, 2]</td>
      <td>[1, 3, -3]</td>
      <td>[3, 3, 3, 5, -7, -9, -11, 13]</td>
      <td>12</td>
      <td>8</td>
      <td>13</td>
      <td>[{'S': 18, 'ψ': [(-7, -11), (-9, -9), (5, 13)]}]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="s1">&#39;ψ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="s1">&#39;ψ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">==</span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="s1">&#39;ψ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>[-2, 0, 2]</td>
      <td>[-2, 1, 0, -2]</td>
      <td>[1, 1, -4, -5, 9, 9, 9, -10, -10]</td>
      <td>4</td>
      <td>9</td>
      <td>10</td>
      <td>[{'S': 9, 'ψ': [(1, -10), (-4, -5)]}]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[1, 0, -1]</td>
      <td>[-3, 3, 0, -3]</td>
      <td>[1, 1, -3, -8, 11, 11, 11, -12, -12]</td>
      <td>9</td>
      <td>9</td>
      <td>12</td>
      <td>[{'S': 11, 'ψ': [(1, -12), (-3, -8)]}]</td>
    </tr>
    <tr>
      <th>5</th>
      <td>[3, 0, -3]</td>
      <td>[-2, 2, 0, -2]</td>
      <td>[4, -5, -5, -6, -6, 11, 11, 11, -15]</td>
      <td>8</td>
      <td>9</td>
      <td>15</td>
      <td>[{'S': 11, 'ψ': [(-5, -6), (4, -15)]}]</td>
    </tr>
    <tr>
      <th>12</th>
      <td>[2, 0, -2]</td>
      <td>[2, -2, 0, -3]</td>
      <td>[2, 2, -3, 15, 15, -17, -17, -17, 20]</td>
      <td>4</td>
      <td>9</td>
      <td>20</td>
      <td>[{'S': 17, 'ψ': [(-3, 20), (2, 15)]}]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Check if <code class="docutils literal notranslate"><span class="pre">sum([L,L,L,x,y])</span></code> where <code class="docutils literal notranslate"><span class="pre">(x,y)</span> <span class="pre">=</span> <span class="pre">±S</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_L</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="n">L</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;solution&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;solution&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span> <span class="p">]</span>
    <span class="k">for</span> <span class="n">LL</span> <span class="ow">in</span> <span class="n">L</span><span class="p">[::</span><span class="mi">3</span><span class="p">]:</span>
        <span class="n">z</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hidden&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">z</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ψ&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="mi">3</span><span class="o">*</span><span class="n">LL</span><span class="o">+</span><span class="nb">sum</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[]</span>
<span class="k">assert</span> <span class="n">check_L</span><span class="p">({</span><span class="s1">&#39;solution&#39;</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
         <span class="s1">&#39;hidden&#39;</span><span class="p">:[{</span><span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;ψ&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">)]}]})</span><span class="o">==</span><span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="n">hs3</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">check_L</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>[-2, -3, 0]</td>
      <td>[1, 2, 3, 2]</td>
      <td>[5, 6, 6, 6, -8, -9, -9, -10, 13]</td>
      <td>4</td>
      <td>9</td>
      <td>13</td>
      <td>[{'S': 18, 'ψ': [(-9, -9), (-8, -10), (5, 13)]}]</td>
    </tr>
    <tr>
      <th>7</th>
      <td>[2, 0, 3]</td>
      <td>[-2, 1, -3, -1]</td>
      <td>[2, 3, 3, 3, 6, -8, -11, -15, 17]</td>
      <td>12</td>
      <td>9</td>
      <td>17</td>
      <td>[{'S': 9, 'ψ': [(2, -11), (6, -15), (-8, 17)]}]</td>
    </tr>
    <tr>
      <th>8</th>
      <td>[-4, -2, 1]</td>
      <td>[2, -4, 4, -2]</td>
      <td>[1, -2, 6, 6, 6, -9, -9, -16, 17]</td>
      <td>16</td>
      <td>9</td>
      <td>17</td>
      <td>[{'S': 18, 'ψ': [(-9, -9), (1, 17), (-2, -16)]}]</td>
    </tr>
    <tr>
      <th>10</th>
      <td>[3, -2, -4]</td>
      <td>[-2, -1, -2, 3]</td>
      <td>[1, 2, 3, -6, -6, -6, 15, 16, -19]</td>
      <td>2</td>
      <td>9</td>
      <td>19</td>
      <td>[{'S': 18, 'ψ': [(1, -19), (3, 15), (2, 16)]}]</td>
    </tr>
    <tr>
      <th>14</th>
      <td>[6, -3, 1]</td>
      <td>[-1, -3, -6, -3]</td>
      <td>[7, 9, 9, 9, -11, -12, -15, -16, 20]</td>
      <td>18</td>
      <td>9</td>
      <td>20</td>
      <td>[{'S': 27, 'ψ': [(7, 20), (-12, -15), (-11, -1...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="extend-the-data-scheme-with-number-of-generations">
<h3>Extend the data scheme with number of generations<a class="headerlink" href="#extend-the-data-scheme-with-number-of-generations" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_Dirac_and_Majorana_generations</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">h</span><span class="p">):</span>
    <span class="n">g</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">dgmax</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">mgmax</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">h</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ψ&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">!=</span><span class="n">y</span> <span class="ow">and</span> <span class="n">l</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">&gt;</span><span class="n">dgmax</span> <span class="ow">and</span> <span class="n">l</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">==</span><span class="n">l</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="n">dgmax</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">==</span><span class="n">y</span> <span class="ow">and</span> <span class="n">l</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">&gt;</span><span class="n">mgmax</span><span class="p">:</span>
                    <span class="n">mgmax</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;DG&#39;</span><span class="p">:</span><span class="n">dgmax</span><span class="p">,</span><span class="s1">&#39;MG&#39;</span><span class="p">:</span><span class="n">mgmax</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">g</span>
<span class="n">l</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">h</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span> <span class="s1">&#39;ψ&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">)]}]</span>
<span class="k">assert</span> <span class="n">get_Dirac_and_Majorana_generations</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">h</span><span class="p">)</span><span class="o">==</span><span class="p">[{</span><span class="s1">&#39;DG&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;MG&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    [-1, -5, -3, -6, -4, -7]
1       [-1, 2, -2, -7, 4, 0]
2       [-1, 0, 1, -4, -2, 2]
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;Generations&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">hs</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">get_Dirac_and_Majorana_generations</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;Generations&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">hs3</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">get_Dirac_and_Majorana_generations</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;Gmax&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;Generations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="o">=</span><span class="n">hs</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;Gmax&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
      <th>~intersections</th>
      <th>Generations</th>
      <th>Gmax</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>157</th>
      <td>[3, 0, -5]</td>
      <td>[-1, 1, -1]</td>
      <td>[4, 4, 4, 11, -12, -13, -19, 21]</td>
      <td>8</td>
      <td>8</td>
      <td>21</td>
      <td>[{'S': 8, 'ψ': [(11, -19), (-13, 21), (4, 4), (4, -12)]}]</td>
      <td>[(11, -19), (-13, 21)]</td>
      <td>[{'DG': 1, 'MG': 3}]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>199</th>
      <td>[-1, 2, -2]</td>
      <td>[-7, 4, 0]</td>
      <td>[1, 2, 2, 2, -3, -5, -6, 7]</td>
      <td>1</td>
      <td>8</td>
      <td>7</td>
      <td>[{'S': 4, 'ψ': [(2, 2), (-3, 7), (1, -5), (2, -6)]}]</td>
      <td>[(-3, 7), (1, -5)]</td>
      <td>[{'DG': 1, 'MG': 3}]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>317</th>
      <td>[-3, -4, -3]</td>
      <td>[-5, 3, -7]</td>
      <td>[3, 5, 5, 7, -9, -15, -15, 19]</td>
      <td>2</td>
      <td>8</td>
      <td>19</td>
      <td>[{'S': 10, 'ψ': [(3, 7), (5, -15), (-9, 19), (5, 5)]}]</td>
      <td>[(3, 7), (-9, 19)]</td>
      <td>[{'DG': 2, 'MG': 2}]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>352</th>
      <td>[0, -1, -2]</td>
      <td>[-1, -6, -5, -6]</td>
      <td>[1, -6, -6, -6, 7, 11, 18, -19]</td>
      <td>2</td>
      <td>8</td>
      <td>19</td>
      <td>[{'S': 12, 'ψ': [(-6, -6), (-6, 18), (1, 11), (7, -19)]}]</td>
      <td>[(1, 11), (7, -19)]</td>
      <td>[{'DG': 1, 'MG': 3}]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>384</th>
      <td>[1, 0, -2]</td>
      <td>[-3, -1, 1]</td>
      <td>[3, 3, 3, 5, -7, -9, -11, 13]</td>
      <td>2</td>
      <td>8</td>
      <td>13</td>
      <td>[{'S': 6, 'ψ': [(5, -11), (3, -9), (3, 3), (-7, 13)]}]</td>
      <td>[(5, -11), (-7, 13)]</td>
      <td>[{'DG': 1, 'MG': 3}]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9320</th>
      <td>[-1, -2, -1]</td>
      <td>[-5, 1, -3]</td>
      <td>[3, 5, 5, -13, 15, -17, -23, 25]</td>
      <td>2</td>
      <td>8</td>
      <td>25</td>
      <td>[{'S': 8, 'ψ': [(-17, 25), (15, -23), (5, -13), (3, 5)]}]</td>
      <td>[(-17, 25), (15, -23)]</td>
      <td>[{'DG': 1, 'MG': 0}]</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9332</th>
      <td>[0, -1, -2]</td>
      <td>[-1, -9, -6, -5]</td>
      <td>[3, -4, -5, 9, 12, -16, -24, 25]</td>
      <td>1</td>
      <td>8</td>
      <td>25</td>
      <td>[{'S': 21, 'ψ': [(3, -24), (-5, -16), (-4, 25), (9, 12)]}]</td>
      <td>[(-5, -16), (-4, 25), (9, 12)]</td>
      <td>[{'DG': 1, 'MG': 0}]</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9333</th>
      <td>[0, -1, -2]</td>
      <td>[-1, -5, -7, -5]</td>
      <td>[1, 1, 5, -11, -13, 19, 23, -25]</td>
      <td>2</td>
      <td>8</td>
      <td>25</td>
      <td>[{'S': 24, 'ψ': [(5, 19), (1, -25), (1, 23), (-11, -13)]}]</td>
      <td>[(5, 19), (-11, -13)]</td>
      <td>[{'DG': 1, 'MG': 0}]</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9336</th>
      <td>[0, -2, 0]</td>
      <td>[-4, -3, -7, -8]</td>
      <td>[9, -11, -12, 14, -21, 22, 24, -25]</td>
      <td>4</td>
      <td>8</td>
      <td>25</td>
      <td>[{'S': 3, 'ψ': [(-11, 14), (-21, 24), (9, -12), (22, -25)]}]</td>
      <td>[(-21, 24), (9, -12), (22, -25)]</td>
      <td>[{'DG': 1, 'MG': 0}]</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9345</th>
      <td>[0, -1, -2]</td>
      <td>[-1, -6, -8, -2]</td>
      <td>[6, -7, -11, 14, 17, -20, -24, 25]</td>
      <td>1</td>
      <td>8</td>
      <td>25</td>
      <td>[{'S': 31, 'ψ': [(-11, -20), (6, 25), (-7, -24), (14, 17)]}]</td>
      <td>[(6, 25), (-7, -24), (14, 17)]</td>
      <td>[{'DG': 1, 'MG': 0}]</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>1773 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">][:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
      <th>~intersections</th>
      <th>Generations</th>
      <th>Gmax</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>157</th>
      <td>[3, 0, -5]</td>
      <td>[-1, 1, -1]</td>
      <td>[4, 4, 4, 11, -12, -13, -19, 21]</td>
      <td>8</td>
      <td>8</td>
      <td>21</td>
      <td>[{'S': 8, 'ψ': [(11, -19), (-13, 21), (4, 4), (4, -12)]}]</td>
      <td>[(11, -19), (-13, 21)]</td>
      <td>[{'DG': 1, 'MG': 3}]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>199</th>
      <td>[-1, 2, -2]</td>
      <td>[-7, 4, 0]</td>
      <td>[1, 2, 2, 2, -3, -5, -6, 7]</td>
      <td>1</td>
      <td>8</td>
      <td>7</td>
      <td>[{'S': 4, 'ψ': [(2, 2), (-3, 7), (1, -5), (2, -6)]}]</td>
      <td>[(-3, 7), (1, -5)]</td>
      <td>[{'DG': 1, 'MG': 3}]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>317</th>
      <td>[-3, -4, -3]</td>
      <td>[-5, 3, -7]</td>
      <td>[3, 5, 5, 7, -9, -15, -15, 19]</td>
      <td>2</td>
      <td>8</td>
      <td>19</td>
      <td>[{'S': 10, 'ψ': [(3, 7), (5, -15), (-9, 19), (5, 5)]}]</td>
      <td>[(3, 7), (-9, 19)]</td>
      <td>[{'DG': 2, 'MG': 2}]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>352</th>
      <td>[0, -1, -2]</td>
      <td>[-1, -6, -5, -6]</td>
      <td>[1, -6, -6, -6, 7, 11, 18, -19]</td>
      <td>2</td>
      <td>8</td>
      <td>19</td>
      <td>[{'S': 12, 'ψ': [(-6, -6), (-6, 18), (1, 11), (7, -19)]}]</td>
      <td>[(1, 11), (7, -19)]</td>
      <td>[{'DG': 1, 'MG': 3}]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>384</th>
      <td>[1, 0, -2]</td>
      <td>[-3, -1, 1]</td>
      <td>[3, 3, 3, 5, -7, -9, -11, 13]</td>
      <td>2</td>
      <td>8</td>
      <td>13</td>
      <td>[{'S': 6, 'ψ': [(5, -11), (3, -9), (3, 3), (-7, 13)]}]</td>
      <td>[(5, -11), (-7, 13)]</td>
      <td>[{'DG': 1, 'MG': 3}]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>392</th>
      <td>[0, -2, 0]</td>
      <td>[-3, -1, 1, -1]</td>
      <td>[5, 5, 5, -15, 19, -21, -29, 31]</td>
      <td>2</td>
      <td>8</td>
      <td>31</td>
      <td>[{'S': 10, 'ψ': [(-21, 31), (5, -15), (19, -29), (5, 5)]}]</td>
      <td>[(-21, 31), (19, -29)]</td>
      <td>[{'DG': 1, 'MG': 3}]</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">9</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
      <th>~intersections</th>
      <th>Generations</th>
      <th>Gmax</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">][:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
      <th>~intersections</th>
      <th>Generations</th>
      <th>Gmax</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">][:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
      <th>~intersections</th>
      <th>Generations</th>
      <th>Gmax</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[-1, 0, -3, 0, -1]</td>
      <td>[-1, 1, -1, -3, -1]</td>
      <td>[5, 5, 7, 7, 7, 7, 7, -15, -19, -19, -21, 29]</td>
      <td>2</td>
      <td>12</td>
      <td>29</td>
      <td>[{'S': 14, 'ψ': [(-15, 29), (7, 7), (7, -21), (5, -19)]}]</td>
      <td>[(-15, 29), (5, -19)]</td>
      <td>[{'DG': 2, 'MG': 5}]</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[1, 0, -2, 0, -2]</td>
      <td>[-3, -1, 1, -1, 1]</td>
      <td>[1, 1, 7, 7, 7, 7, 7, -11, -15, -15, -21, 25]</td>
      <td>2</td>
      <td>12</td>
      <td>25</td>
      <td>[{'S': 14, 'ψ': [(1, -15), (7, 7), (-11, 25), (7, -21)]}]</td>
      <td>[(1, -15), (-11, 25)]</td>
      <td>[{'DG': 2, 'MG': 5}]</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[1, 0, -1, 0, -3]</td>
      <td>[-2, 2, -2, 2, 3]</td>
      <td>[3, -7, -8, -8, 14, 14, 14, 14, -20, -20, -21, 25]</td>
      <td>4</td>
      <td>12</td>
      <td>25</td>
      <td>[{'S': 28, 'ψ': [(-8, -20), (3, 25), (-7, -21), (14, 14)]}]</td>
      <td>[(3, 25), (-7, -21), (14, 14)]</td>
      <td>[{'DG': 2, 'MG': 4}]</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[3, 0, -2, 0, -3]</td>
      <td>[-1, 1, -1, 1, -1]</td>
      <td>[1, 1, 1, 1, 1, -3, 5, -7, 8, -10, -10, 12]</td>
      <td>8</td>
      <td>12</td>
      <td>12</td>
      <td>[{'S': 2, 'ψ': [(1, -3), (8, -10), (-10, 12), (-3, 5), (5, -7), (1, 1)]}]</td>
      <td>[(8, -10), (-10, 12), (5, -7)]</td>
      <td>[{'DG': 1, 'MG': 5}]</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;Gmax&#39;</span><span class="p">]</span><span class="o">=-</span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;Generations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="n">hs3</span><span class="o">=</span><span class="n">hs3</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;Gmax&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">][:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
      <th>Generations</th>
      <th>Gmax</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[1, 0, -2]</td>
      <td>[-3, -1, 1]</td>
      <td>[3, 3, 3, 5, -7, -9, -11, 13]</td>
      <td>2</td>
      <td>8</td>
      <td>13</td>
      <td>[{'S': 18, 'ψ': [(-7, -11), (-9, -9), (5, 13)]}]</td>
      <td>[{'DG': 1, 'MG': 1}]</td>
      <td>-2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">9</span><span class="p">][:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
      <th>Generations</th>
      <th>Gmax</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>[-2, -1, 0]</td>
      <td>[-1, -3, -5, -3]</td>
      <td>[5, 6, 6, 6, -8, -9, -9, -10, 13]</td>
      <td>2</td>
      <td>9</td>
      <td>13</td>
      <td>[{'S': 18, 'ψ': [(-9, -9), (-8, -10), (5, 13)]}]</td>
      <td>[{'DG': 1, 'MG': 2}]</td>
      <td>-3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[1, -2, -1]</td>
      <td>[-4, -9, -5, -3]</td>
      <td>[1, -2, 6, 6, 6, -9, -9, -16, 17]</td>
      <td>6</td>
      <td>9</td>
      <td>17</td>
      <td>[{'S': 18, 'ψ': [(-9, -9), (1, 17), (-2, -16)]}]</td>
      <td>[{'DG': 1, 'MG': 2}]</td>
      <td>-3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>[-2, 0, 2]</td>
      <td>[-1, 1, 0, -1]</td>
      <td>[1, 1, -4, -5, 9, 9, 9, -10, -10]</td>
      <td>1</td>
      <td>9</td>
      <td>10</td>
      <td>[{'S': 9, 'ψ': [(1, -10), (-4, -5)]}]</td>
      <td>[{'DG': 2, 'MG': 0}]</td>
      <td>-2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>[-1, 0, 1]</td>
      <td>[-1, -3, 0, -1]</td>
      <td>[1, 1, -3, -8, 11, 11, 11, -12, -12]</td>
      <td>1</td>
      <td>9</td>
      <td>12</td>
      <td>[{'S': 11, 'ψ': [(1, -12), (-3, -8)]}]</td>
      <td>[{'DG': 2, 'MG': 0}]</td>
      <td>-2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">10</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
      <th>Generations</th>
      <th>Gmax</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>43</th>
      <td>[-3, 3, 0, -6]</td>
      <td>[-3, -2, 3, 4]</td>
      <td>[3, 3, 3, -4, 9, 9, -10, -14, -27, 28]</td>
      <td>18</td>
      <td>10</td>
      <td>28</td>
      <td>[{'S': 18, 'ψ': [(-10, 28), (-4, -14), (9, -27), (9, 9)]}]</td>
      <td>[{'DG': 1, 'MG': 2}]</td>
      <td>-3</td>
    </tr>
    <tr>
      <th>44</th>
      <td>[-1, 0, -4, -3]</td>
      <td>[-3, 1, -1, -5]</td>
      <td>[1, -3, -3, -3, -9, -9, 11, 17, 27, -29]</td>
      <td>2</td>
      <td>10</td>
      <td>29</td>
      <td>[{'S': 18, 'ψ': [(-9, 27), (11, -29), (1, 17), (-9, -9)]}]</td>
      <td>[{'DG': 1, 'MG': 2}]</td>
      <td>-3</td>
    </tr>
    <tr>
      <th>45</th>
      <td>[3, -1, -3, 0]</td>
      <td>[-2, -1, 1, -3, -4]</td>
      <td>[3, 3, 3, 4, -6, -7, 9, -11, -12, 14]</td>
      <td>1</td>
      <td>10</td>
      <td>14</td>
      <td>[{'S': 18, 'ψ': [(-6, -12), (4, 14), (-7, -11), (9, 9)]}]</td>
      <td>[{'DG': 1, 'MG': 1}]</td>
      <td>-2</td>
    </tr>
    <tr>
      <th>46</th>
      <td>[0, 1, 0, -2]</td>
      <td>[-1, -3, 3, -1, -3]</td>
      <td>[1, -5, -7, 9, -11, -13, 15, 15, 15, -19]</td>
      <td>4</td>
      <td>10</td>
      <td>19</td>
      <td>[{'S': 18, 'ψ': [(-5, -13), (1, -19), (-7, -11), (9, 9)]}]</td>
      <td>[{'DG': 1, 'MG': 1}]</td>
      <td>-2</td>
    </tr>
    <tr>
      <th>47</th>
      <td>[1, 0, 2, 0]</td>
      <td>[-3, 0, -3, -2, -1]</td>
      <td>[1, -2, 3, 3, 3, -6, 9, -12, -19, 20]</td>
      <td>6</td>
      <td>10</td>
      <td>20</td>
      <td>[{'S': 18, 'ψ': [(-2, 20), (-6, -12), (1, -19), (9, 9)]}]</td>
      <td>[{'DG': 1, 'MG': 1}]</td>
      <td>-2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
      <th>Generations</th>
      <th>Gmax</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>49</th>
      <td>[2, -1, 2, -1]</td>
      <td>[-2, -1, -2, 2, 4]</td>
      <td>[4, 5, 8, -9, -9, 10, -12, -12, -12, 13, 14]</td>
      <td>1</td>
      <td>11</td>
      <td>14</td>
      <td>[{'S': 18, 'ψ': [(5, 13), (4, 14), (-9, -9), (8, 10)]}]</td>
      <td>[{'DG': 1, 'MG': 2}]</td>
      <td>-3</td>
    </tr>
    <tr>
      <th>50</th>
      <td>[2, 3, 0, -3, 3]</td>
      <td>[0, -3, 1, -1, -3]</td>
      <td>[1, 1, -2, -3, 6, 6, 6, -7, -10, -10, 12]</td>
      <td>15</td>
      <td>11</td>
      <td>12</td>
      <td>[{'S': 9, 'ψ': [(-3, 12), (1, -10), (-2, -7)]}]</td>
      <td>[{'DG': 2, 'MG': 0}]</td>
      <td>-2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
      <th>Generations</th>
      <th>Gmax</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>[1, -3, -2, 0, -1]</td>
      <td>[-3, -1, -3, -1, -3]</td>
      <td>[1, 1, 3, 3, 3, 5, 5, -7, -9, -9, -9, 13]</td>
      <td>2</td>
      <td>12</td>
      <td>13</td>
      <td>[{'S': 6, 'ψ': [(1, 5), (3, 3), (-7, 13), (1, -7)]}]</td>
      <td>[{'DG': 2, 'MG': 3}]</td>
      <td>-5</td>
    </tr>
    <tr>
      <th>65</th>
      <td>[1, 0, 2, 0, 2]</td>
      <td>[-3, -1, -3, -1, -3]</td>
      <td>[7, 9, 9, 9, 11, -13, -13, -27, -27, -27, 31, 31]</td>
      <td>2</td>
      <td>12</td>
      <td>31</td>
      <td>[{'S': 18, 'ψ': [(9, 9), (7, 11), (-13, 31)]}]</td>
      <td>[{'DG': 2, 'MG': 3}]</td>
      <td>-5</td>
    </tr>
    <tr>
      <th>66</th>
      <td>[-3, -1, -2, 3, -3]</td>
      <td>[-3, -2, -3, -2, 0]</td>
      <td>[3, 3, 3, 6, 7, -8, -9, -9, -9, -10, 11, 12]</td>
      <td>19</td>
      <td>12</td>
      <td>12</td>
      <td>[{'S': 18, 'ψ': [(6, 12), (-9, -9), (-8, -10), (7, 11)]}]</td>
      <td>[{'DG': 1, 'MG': 3}]</td>
      <td>-4</td>
    </tr>
    <tr>
      <th>67</th>
      <td>[-3, -1, 2, 0, -3]</td>
      <td>[-3, -2, -1, -2, -3]</td>
      <td>[3, 4, -8, -9, -9, -9, -10, 14, 15, 15, 15, -21]</td>
      <td>12</td>
      <td>12</td>
      <td>21</td>
      <td>[{'S': 18, 'ψ': [(3, -21), (4, 14), (-9, -9), (-8, -10)]}]</td>
      <td>[{'DG': 1, 'MG': 3}]</td>
      <td>-4</td>
    </tr>
    <tr>
      <th>68</th>
      <td>[-3, 0, -3, -1, 3]</td>
      <td>[-3, -1, -3, -1, 1]</td>
      <td>[2, 6, 6, 6, -7, -16, -20, -20, -20, 21, 21, 21]</td>
      <td>8</td>
      <td>12</td>
      <td>21</td>
      <td>[{'S': 14, 'ψ': [(2, -16), (-7, -7), (6, -20)]}]</td>
      <td>[{'DG': 3, 'MG': 1}]</td>
      <td>-4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;~intersections&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">lst</span><span class="p">:</span> <span class="n">intersections</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">hs3</span><span class="p">[</span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;~intersections&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">==</span><span class="n">hs3</span><span class="p">[</span><span class="s1">&#39;~intersections&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
      <th>hidden</th>
      <th>Generations</th>
      <th>Gmax</th>
      <th>~intersections</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>[-2, 0, 2]</td>
      <td>[-1, 1, 0, -1]</td>
      <td>[1, 1, -4, -5, 9, 9, 9, -10, -10]</td>
      <td>1</td>
      <td>9</td>
      <td>10</td>
      <td>[{'S': 9, 'ψ': [(1, -10), (-4, -5)]}]</td>
      <td>[{'DG': 2, 'MG': 0}]</td>
      <td>-2</td>
      <td>[(-4, -5)]</td>
    </tr>
    <tr>
      <th>6</th>
      <td>[-1, 0, 1]</td>
      <td>[-1, -3, 0, -1]</td>
      <td>[1, 1, -3, -8, 11, 11, 11, -12, -12]</td>
      <td>1</td>
      <td>9</td>
      <td>12</td>
      <td>[{'S': 11, 'ψ': [(1, -12), (-3, -8)]}]</td>
      <td>[{'DG': 2, 'MG': 0}]</td>
      <td>-2</td>
      <td>[(-3, -8)]</td>
    </tr>
    <tr>
      <th>7</th>
      <td>[-1, 0, -1, 1]</td>
      <td>[-3, 0, -1, 0]</td>
      <td>[4, -5, -5, -6, -6, 11, 11, 11, -15]</td>
      <td>1</td>
      <td>9</td>
      <td>15</td>
      <td>[{'S': 11, 'ψ': [(-5, -6), (4, -15)]}]</td>
      <td>[{'DG': 2, 'MG': 0}]</td>
      <td>-2</td>
      <td>[(4, -15)]</td>
    </tr>
    <tr>
      <th>8</th>
      <td>[-1, 0, 1]</td>
      <td>[-1, -5, 0, 5]</td>
      <td>[2, 2, -3, 15, 15, -17, -17, -17, 20]</td>
      <td>3</td>
      <td>9</td>
      <td>20</td>
      <td>[{'S': 17, 'ψ': [(-3, 20), (2, 15)]}]</td>
      <td>[{'DG': 2, 'MG': 0}]</td>
      <td>-2</td>
      <td>[(2, 15)]</td>
    </tr>
    <tr>
      <th>9</th>
      <td>[-1, 0, -1, 1]</td>
      <td>[-3, 0, -3, 0]</td>
      <td>[2, 2, -7, -12, 19, 19, 19, -21, -21]</td>
      <td>1</td>
      <td>9</td>
      <td>21</td>
      <td>[{'S': 19, 'ψ': [(-7, -12), (2, -21)]}]</td>
      <td>[{'DG': 2, 'MG': 0}]</td>
      <td>-2</td>
      <td>[(2, -21)]</td>
    </tr>
    <tr>
      <th>10</th>
      <td>[-1, 0, 1]</td>
      <td>[-1, 1, 0, -7]</td>
      <td>[3, 3, -4, 14, 14, -17, -17, -17, 21]</td>
      <td>3</td>
      <td>9</td>
      <td>21</td>
      <td>[{'S': 17, 'ψ': [(-4, 21), (3, 14)]}]</td>
      <td>[{'DG': 2, 'MG': 0}]</td>
      <td>-2</td>
      <td>[(3, 14)]</td>
    </tr>
    <tr>
      <th>11</th>
      <td>[1, 0, 1, -1]</td>
      <td>[-3, 0, -3, 0]</td>
      <td>[4, 4, -5, 15, 15, -19, -19, -19, 24]</td>
      <td>1</td>
      <td>9</td>
      <td>24</td>
      <td>[{'S': 19, 'ψ': [(4, 15), (-5, 24)]}]</td>
      <td>[{'DG': 2, 'MG': 0}]</td>
      <td>-2</td>
      <td>[(-5, 24)]</td>
    </tr>
    <tr>
      <th>64</th>
      <td>[1, -3, -2, 0, -1]</td>
      <td>[-3, -1, -3, -1, -3]</td>
      <td>[1, 1, 3, 3, 3, 5, 5, -7, -9, -9, -9, 13]</td>
      <td>2</td>
      <td>12</td>
      <td>13</td>
      <td>[{'S': 6, 'ψ': [(1, 5), (3, 3), (-7, 13), (1, -7)]}]</td>
      <td>[{'DG': 2, 'MG': 3}]</td>
      <td>-5</td>
      <td>[(3, 3)]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="appendix-use-merge-to-compare-two-dataframes">
<h2>Appendix: Use merge to compare two DataFrames<a class="headerlink" href="#appendix-use-merge-to-compare-two-dataframes" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;solutions.json.gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_hidden_sector</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 11min 16s, sys: 719 ms, total: 11min 16s
Wall time: 11min 16s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs2</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="c1">#.iloc[0].to_dict()</span>
<span class="n">hs2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(9466, 6)
</pre></div>
</div>
</div>
</div>
<p>Columns can only be compared if they are simple objects, like strings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="p">[</span><span class="s1">&#39;ss&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">hs</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">hs2</span><span class="p">[</span><span class="s1">&#39;ss&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hs2</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Increase the with of the columns for easier visualization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Compare the larger DataFrame (with filtered columns) against the smaller. The non <code class="docutils literal notranslate"><span class="pre">on='s'</span></code> repeated columns will appears with suffixes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span><span class="o">=</span><span class="n">hs2</span><span class="p">[[</span><span class="s1">&#39;ss&#39;</span><span class="p">,</span><span class="s1">&#39;hidden&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">hs</span><span class="p">[[</span><span class="s1">&#39;ss&#39;</span><span class="p">,</span><span class="s1">&#39;hidden&#39;</span><span class="p">]],</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;ss&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_1&#39;</span><span class="p">,</span><span class="s1">&#39;_2&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#tmp=</span>
<span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;hidden_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="kc">True</span> <span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ss</th>
      <th>hidden_1</th>
      <th>hidden_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[3, 3, -4, -4, -4, 5, -6, 7, -8, 9, 10, -11]</td>
      <td>[{'S': 1, 'ψ': [(-6, 7), (7, -8), (5, -6), (-8, 9), (3, -4), (10, -11), (-4, 5)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[1, -3, 5, -7, -7, -7, -8, 9, 9, 10, 12, -14]</td>
      <td>[{'S': 2, 'ψ': [(1, -3), (-8, 10), (-3, 5), (5, -7), (1, 1), (-7, 9), (12, -14)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[1, -2, -3, 4, 5, -7, -9, -9, 11, 11, 12, -14]</td>
      <td>[{'S': 2, 'ψ': [(1, -3), (-9, 11), (-2, 4), (-3, 5), (5, -7), (1, 1), (12, -14)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[1, -2, 3, -4, -6, 7, -8, 9, -10, 11, 14, -15]</td>
      <td>[{'S': 1, 'ψ': [(14, -15), (-6, 7), (3, -4), (1, -2), (-8, 9), (-10, 11), (9, -10), (7, -8), (-2, 3)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[1, 4, -5, -6, -7, -7, -9, 10, 11, 12, 12, -16]</td>
      <td>[{'S': 5, 'ψ': [(11, -16), (1, -6), (-6, 11), (-5, 10), (1, 4), (-7, 12), (4, -9)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>[3, -4, 6, -9, 10, -11, -11, -12, 15, 17, 17, -21]</td>
      <td>[{'S': 6, 'ψ': [(-11, 17), (-4, 10), (3, -9), (3, 3), (15, -21), (6, -12), (-9, 15)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>[4, -5, 8, -9, -11, 12, -13, 14, -15, 16, 21, -22]</td>
      <td>[{'S': 1, 'ψ': [(-13, 14), (8, -9), (14, -15), (4, -5), (21, -22), (12, -13), (-11, 12), (-15, 16)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>[1, -2, 9, -10, -11, 12, -13, 14, -15, 16, 21, -22]</td>
      <td>[{'S': 1, 'ψ': [(-13, 14), (14, -15), (1, -2), (21, -22), (12, -13), (-11, 12), (9, -10), (-15, 16)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>[1, -4, -5, 7, 8, -10, -11, 14, -17, 20, 20, -23]</td>
      <td>[{'S': 3, 'ψ': [(-17, 20), (-11, 14), (20, -23), (-4, 7), (-5, 8), (1, -4), (8, -11), (7, -10), (14, -17)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>[6, -7, 9, -10, -12, 13, -14, 15, -16, 17, 22, -23]</td>
      <td>[{'S': 1, 'ψ': [(-12, 13), (-14, 15), (6, -7), (-16, 17), (15, -16), (22, -23), (13, -14), (9, -10)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>[3, 4, 6, 11, -12, -13, 14, -15, -20, 21, -23, 24]</td>
      <td>[{'S': 9, 'ψ': [(11, -20), (3, 6), (-12, 21), (-15, 24), (6, -15), (14, -23), (3, -12), (4, -13)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>[1, 2, 4, -7, -9, 10, 14, -15, 18, -19, -23, 24]</td>
      <td>[{'S': 5, 'ψ': [(2, -7), (10, -15), (18, -23), (-19, 24), (1, 4), (-9, 14), (14, -19), (4, -9)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>[1, 3, 5, 7, -9, -11, -15, -15, 17, 19, 23, -25]</td>
      <td>[{'S': 8, 'ψ': [(-15, 23), (1, -9), (-9, 17), (17, -25), (-11, 19), (7, -15), (3, 5), (1, 7), (3, -11)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>[1, -2, -3, -4, -5, -8, 9, 12, -16, 18, 23, -25]</td>
      <td>[{'S': 7, 'ψ': [(-2, 9), (-2, -5), (-16, 23), (-3, -4), (18, -25), (9, -16), (-5, 12), (1, -8)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14</th>
      <td>[3, -5, -6, -9, 11, 12, 15, 16, -21, -21, -22, 27]</td>
      <td>[{'S': 6, 'ψ': [(3, -9), (3, 3), (-6, 12), (-5, 11), (-21, 27), (16, -22), (15, -21), (-9, 15)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>[3, -8, -9, 14, 15, -19, -19, -21, 24, 25, 25, -30]</td>
      <td>[{'S': 6, 'ψ': [(-19, 25), (3, -9), (3, 3), (24, -30), (15, -21), (-8, 14), (-9, 15)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16</th>
      <td>[3, -9, -14, 15, -17, -17, 20, -21, 23, 23, 24, -30]</td>
      <td>[{'S': 6, 'ψ': [(-17, 23), (3, -9), (3, 3), (-14, 20), (24, -30), (15, -21), (-9, 15)]}]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17</th>
      <td>[1, -3, -4, 6, 10, -16, -17, -20, 23, 24, 27, -31]</td>
      <td>[{'S': 7, 'ψ': [(24, -31), (10, -17), (-3, 10), (-16, 23), (-3, -4), (-17, 24), (-20, 27), (1, 6)]}]</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;ss&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">eval</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;ss&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">eval</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span><span class="o">=</span><span class="n">tmp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;zmax&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>There are plenty of new solutions with the new dataset build with the Multiprocessing algorithm in the previous Chapter</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ss</th>
      <th>hidden_1</th>
      <th>hidden_2</th>
      <th>zmax</th>
      <th>n</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(9466, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;hidden_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="kc">True</span> <span class="p">)][:</span><span class="mi">5</span><span class="p">][[</span><span class="s2">&quot;ss&quot;</span><span class="p">,</span><span class="s1">&#39;hidden_1&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;hidden_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="kc">True</span> <span class="p">)][:</span><span class="mi">5</span><span class="p">][[</span><span class="s2">&quot;ss&quot;</span><span class="p">,</span><span class="s1">&#39;hidden_1&#39;</span><span class="p">]]</span>

<span class="nn">File /usr/local/lib/python3.9/dist-packages/pandas/core/frame.py:3811,</span> in <span class="ni">DataFrame.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">3809</span>     <span class="k">if</span> <span class="n">is_iterator</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">3810</span>         <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3811</span>     <span class="n">indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">_get_indexer_strict</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;columns&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">3813</span> <span class="c1"># take() does not accept boolean indexers</span>
<span class="g g-Whitespace">   </span><span class="mi">3814</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="s2">&quot;dtype&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>

<span class="nn">File /usr/local/lib/python3.9/dist-packages/pandas/core/indexes/base.py:6108,</span> in <span class="ni">Index._get_indexer_strict</span><span class="nt">(self, key, axis_name)</span>
<span class="g g-Whitespace">   </span><span class="mi">6105</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">6106</span>     <span class="n">keyarr</span><span class="p">,</span> <span class="n">indexer</span><span class="p">,</span> <span class="n">new_indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reindex_non_unique</span><span class="p">(</span><span class="n">keyarr</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">6108</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raise_if_missing</span><span class="p">(</span><span class="n">keyarr</span><span class="p">,</span> <span class="n">indexer</span><span class="p">,</span> <span class="n">axis_name</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6110</span> <span class="n">keyarr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">indexer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6111</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">Index</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">6112</span>     <span class="c1"># GH 42790 - Preserve name from an Index</span>

<span class="nn">File /usr/local/lib/python3.9/dist-packages/pandas/core/indexes/base.py:6168,</span> in <span class="ni">Index._raise_if_missing</span><span class="nt">(self, key, indexer, axis_name)</span>
<span class="g g-Whitespace">   </span><span class="mi">6166</span>     <span class="k">if</span> <span class="n">use_interval_msg</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">6167</span>         <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">6168</span>     <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;None of [</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">] are in the [</span><span class="si">{</span><span class="n">axis_name</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6170</span> <span class="n">not_found</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ensure_index</span><span class="p">(</span><span class="n">key</span><span class="p">)[</span><span class="n">missing_mask</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="g g-Whitespace">   </span><span class="mi">6171</span> <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">not_found</span><span class="si">}</span><span class="s2"> not in index&quot;</span><span class="p">)</span>

<span class="ne">KeyError</span>: &quot;None of [Index([&#39;ss&#39;, &#39;hidden_1&#39;], dtype=&#39;object&#39;)] are in the [columns]&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">mh</span>

<span class="k">def</span> <span class="nf">remove_double_intersection_pairs</span><span class="p">(</span><span class="n">msvp</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Example:</span>
<span class="sd">        msvp = [(3,4),(6,-13),(1,6),(-7,14),(1,-8)]</span>
<span class="sd">        l = [1, 3, 4, 6, -7, -8, -13, 14]</span>
<span class="sd">        # Remove (1,6) because is fully contained </span>
<span class="sd">        # in the intersections with (_1_,-8) and (_6_,-13)</span>
<span class="sd">        returns: </span>
<span class="sd">        [(3,4),(6,-13),(-7,14),(1,-8)]    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">msvp</span><span class="o">.</span><span class="n">copy</span><span class="p">():</span>
        <span class="n">tmp</span><span class="o">=</span><span class="n">msvp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">fltmp</span><span class="o">=</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">tmp</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])</span> 
        <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">l</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">fltmp</span><span class="p">):</span>
            <span class="n">msvp</span><span class="o">=</span><span class="n">tmp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">msvp</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">remove_double_intersection_pairs</span><span class="p">([(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">)],</span>
                                             <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">]))</span><span class="o">==</span><span class="mi">2</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">remove_double_intersection_pairs</span><span class="p">([(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">)],[</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">]))</span><span class="o">==</span><span class="mi">1</span>

<span class="k">def</span> <span class="nf">get_real_massless</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">msvp</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Example:</span>
<span class="sd">        l = [1, 3, 4, 6, -7, -8, -13, 14]</span>
<span class="sd">        msvp = [(3,4),(6,-13),(-7,14),(1,-8)]</span>
<span class="sd">        [1, 3, 4, 6, -7, -8, -13, 14] → [(3,4),(6,-13),(-7,14),(1,-8)]</span>
<span class="sd">        [1, 6, -7, -8, -13, 14] → [(6,-13),(-7,14),(1,-8)]</span>
<span class="sd">        [1, -7, -8, 14] → [(-7,14),(1,-8)]</span>
<span class="sd">        [1, -8] → [(1,-8)]</span>
<span class="sd">        [] → []</span>
<span class="sd">        </span>
<span class="sd">        returns:</span>
<span class="sd">        [] # lp    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">lp</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">msvp</span><span class="p">:</span>
        <span class="c1">#print(lp,msvp,x,y)</span>
        <span class="k">if</span> <span class="n">lp</span> <span class="ow">and</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lp</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">lp</span><span class="p">:</span>
            <span class="n">minxy</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">lp</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">lp</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">!=</span><span class="n">y</span><span class="p">:</span>
                <span class="p">[(</span><span class="n">lp</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">lp</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">minxy</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="p">[</span> <span class="n">lp</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lp</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="p">]</span> <span class="c1"># abs(2*x)==s</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># not lp</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">lp</span>

<span class="k">def</span> <span class="nf">get_hidden_fermions</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">ps</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    For a given scalar Abelian charge `s`, build the </span>
<span class="sd">    fermion non-zero determinant mass matrix from their</span>
<span class="sd">    Abelian charges in `l`, and returns the input `s` and </span>
<span class="sd">    the non-zero mass entries.</span>
<span class="sd">    Returns an empty dictionary otherwise.</span>
<span class="sd">    </span>
<span class="sd">    The list of combinations on pairs of `l` can be given in `ps`,</span>
<span class="sd">    otherwise it is internally calculated.</span>
<span class="sd">    </span>
<span class="sd">    Example:</span>
<span class="sd">        l = [1, 3, 4, 6, -7, -8, -13, 14]</span>
<span class="sd">        s = 7</span>
<span class="sd">        ps = [(3,4),(6,-13),(1,6),(-7,14),(1,-8)]</span>
<span class="sd">        # If necessary temove [1,6] because have is fully contained </span>
<span class="sd">        # in the intersections with others</span>
<span class="sd">        [1, 3, 4, 6, -7, -8, -13, 14] → [(3,4),(6,-13),(-7,14),(1,-8)]</span>
<span class="sd">        [1, 6, -7, -8, -13, 14] → [(6,-13),(-7,14),(1,-8)]</span>
<span class="sd">        [1, -7, -8, 14] → [(-7,14),(1,-8)]</span>
<span class="sd">        [1, -8] → [(1,-8)]</span>
<span class="sd">        [] → []</span>
<span class="sd">        </span>
<span class="sd">        returns:</span>
<span class="sd">        {&#39;s&#39;:7, &#39;\psi&#39;:[(3,4),(6,-13),(1,6),(-7,14),(1,-8)]}</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">sltn</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ps</span><span class="p">:</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations_with_replacement</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">msv</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ps</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="o">==</span><span class="n">s</span><span class="p">]</span>
    <span class="n">lmsv</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">msv</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
    <span class="n">massives</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">lmsv</span><span class="p">)</span>        
    <span class="n">massless</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">massives</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">massless</span><span class="p">:</span>
        <span class="n">sltn</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">s</span>
        <span class="n">sltn</span><span class="p">[</span><span class="s1">&#39;ψ&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">msv</span>
    <span class="k">return</span> <span class="n">sltn</span>
<span class="k">assert</span> <span class="n">get_hidden_fermions</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">9</span>    


<span class="k">def</span> <span class="nf">get_hidden_sector</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Extract massive pairs without massles fermions from l</span>
<span class="sd">        [1, 3, 4, 6, -7, -8, -13, 14] → [[3,4],[6,-13],[1,6],[-7,14],[1,-8]]</span>
<span class="sd">        #Remove [1,6] because is already in the pairs list</span>
<span class="sd">        [1, 3, 4, 6, -7, -8, -13, 14] → [[3,4],[6,-13],[-7,14],[1,-8]]</span>
<span class="sd">        [1, 6, -7, -8, -13, 14] → [[6,-13],[-7,14],[1,-8]]</span>
<span class="sd">        [1, -7, -8, 14] → [[-7,14],[1,-8]]</span>
<span class="sd">        [1, -8] → [[1,-8]]</span>
<span class="sd">        [] → []    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">sltns</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations_with_replacement</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">Ss</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ps</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">Ss</span><span class="p">:</span>
        <span class="n">sltn</span><span class="o">=</span><span class="n">get_hidden_fermions</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">ps</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sltn</span><span class="p">:</span>
            <span class="n">sltns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sltn</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sltns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_hidden_sector</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 30s, sys: 47.4 ms, total: 1min 31s
Wall time: 1min 31s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="c1">#.iloc[0].to_dict()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="o">.</span><span class="n">shape</span> <span class="c1">#9466 solutions with hidden sector</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(12789, 6)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0         7
1        11
2        11
3        12
4        15
         ..
12784    32
12785    32
12786    32
12787    32
12788    32
Name: solution, Length: 12789, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs8</span><span class="o">=</span><span class="n">hs</span><span class="p">[</span> <span class="p">(</span><span class="n">hs</span><span class="o">.</span><span class="n">n</span><span class="o">==</span><span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hs</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">)][[</span><span class="s1">&#39;solution&#39;</span><span class="p">,</span><span class="s1">&#39;hidden&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs8</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">hs8</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs8</span><span class="o">=</span><span class="n">hs8</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;solution&#39;</span><span class="p">:</span><span class="s1">&#39;lista&#39;</span><span class="p">,</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span><span class="s1">&#39;pares&#39;</span><span class="p">},</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs8</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lista</th>
      <th>pares</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11</th>
      <td>[1, 1, 2, 3, -4, -4, -5, 6]</td>
      <td>{'S': 2, 'ψ': [(3, -5), (2, -4), (-4, 6), (1, 1)]}</td>
    </tr>
    <tr>
      <th>12</th>
      <td>[1, 2, 2, 2, -3, -5, -6, 7]</td>
      <td>{'S': 4, 'ψ': [(2, 2), (-3, 7), (1, -5), (2, -6)]}</td>
    </tr>
    <tr>
      <th>13</th>
      <td>[1, -2, -2, 4, 5, -7, -7, 8]</td>
      <td>{'S': 9, 'ψ': [(4, 5), (1, 8), (-2, -7)]}</td>
    </tr>
    <tr>
      <th>14</th>
      <td>[1, 2, 2, 4, -5, -5, -7, 8]</td>
      <td>{'S': 3, 'ψ': [(4, -7), (-5, 8), (2, -5), (1, 2)]}</td>
    </tr>
    <tr>
      <th>15</th>
      <td>[2, -3, -4, 5, -6, 7, 7, -8]</td>
      <td>{'S': 1, 'ψ': [(-6, 7), (7, -8), (5, -6), (2, -3), (-4, 5)]}</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>251</th>
      <td>[2, -4, -5, 10, 11, -16, -17, 19]</td>
      <td>{'S': 21, 'ψ': [(-4, -17), (-5, -16), (10, 11), (2, 19)]}</td>
    </tr>
    <tr>
      <th>252</th>
      <td>[5, -7, -7, 11, 13, -17, -17, 19]</td>
      <td>{'S': 24, 'ψ': [(5, 19), (-7, -17), (11, 13)]}</td>
    </tr>
    <tr>
      <th>253</th>
      <td>[4, -5, -7, 8, -17, 18, 18, -19]</td>
      <td>{'S': 1, 'ψ': [(-7, 8), (4, -5), (-17, 18), (18, -19)]}</td>
    </tr>
    <tr>
      <th>254</th>
      <td>[2, 2, 5, -7, 10, -14, -17, 19]</td>
      <td>{'S': 12, 'ψ': [(2, -14), (2, 10), (-7, 19), (5, -17)]}</td>
    </tr>
    <tr>
      <th>255</th>
      <td>[2, -3, -3, 6, 10, -13, -18, 19]</td>
      <td>{'S': 16, 'ψ': [(-3, -13), (6, 10), (2, -18), (-3, 19)]}</td>
    </tr>
  </tbody>
</table>
<p>245 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs8</span><span class="p">[</span><span class="s1">&#39;pares&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">hs8</span><span class="o">.</span><span class="n">pares</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">),</span><span class="s1">&#39;ψ&#39;</span><span class="p">:</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ψ&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">[(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ψ&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">!=</span><span class="n">y</span><span class="p">]})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs8</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;lista_pares.json&#39;</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;lista_pares.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lista                                                      [1, 2, 2, 2, -3, -5, -6, 7]
pares    {&#39;S&#39;: 4, &#39;ψ&#39;: [[2, 2], [-3, 7], [1, -5], [2, -6], [7, -3], [-5, 1], [-6, 2]]}
Name: 1, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>A) Cargue los datos disponibles en:</p>
<p><a class="reference external" href="https://raw.githubusercontent.com/ComputationalMethods/Evaluacion_2022-1/main/data/lista_pares.json">https://github.com/ComputationalMethods/Evaluacion_2022-1/blob/main/data/lista_pares.json</a></p>
<p>como un DataFrame de pandas. Este contendrá dos columnas. La columna <code class="docutils literal notranslate"><span class="pre">lista</span></code>, con una lista de 8 enteros (algunos de ellos repetidos) y una columna <code class="docutils literal notranslate"><span class="pre">pares</span></code> correspondiente a un diccionario
con dos items: un entero rotulado con <code class="docutils literal notranslate"><span class="pre">'S'</span></code> y una lista de pares de enteros routulada con <code class="docutils literal notranslate"><span class="pre">'ψ'</span></code>. Note que el resultado de la suma en valor absoluto de los dos enteros en cada uno de los pares reproduce el valor del correspondiente <code class="docutils literal notranslate"><span class="pre">'S'</span></code></p>
<p>Seleccione la fila del DataFrame con el índice correspondiente a los dos últimos dígitos de su cédula y desarrolle los siguientes puntos con la correspondiente  <code class="docutils literal notranslate"><span class="pre">lista</span></code> y <code class="docutils literal notranslate"><span class="pre">pares</span></code>:</p>
<ol class="simple">
<li><p>Construya una matrix <span class="math notranslate nohighlight">\(8\times 8\)</span> <em>simétrica</em> donde cada fila y la correspondiente columna correspondan a un entero de la lista (incluyendo los repetidos); de manera que en los cruces de filas y columnas definidos por los pares de enteros, se genere una entrada aleatoria mayor que cero y menor o igual que 1, con las demas entradas iguales a cero.</p></li>
<li><p>Calcule el determinante y establezca explícitamente si es diferente cero (tenga en cuenta la precisión numérica). Recuerde que si el determinante es cero, se espera que al menos uno de los autovalores sea cero</p></li>
<li><p>Organize los autovalores y autovectores de menor a mayor en valor absoluto y compruebe que las matriz de autovectores organizada da lugar a los autovalores en el orden correcto.</p></li>
<li><p>Establezca explícitamente <em>cuantos</em> autovalores son degenerados en valor absoluto.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="mi">1</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="o">-</span><span class="mi">3</span> <span class="o">-</span><span class="mi">5</span> <span class="o">-</span><span class="mi">6</span> <span class="mi">7</span>
<span class="mi">1</span>  <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="n">x</span>  <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">2</span>  <span class="mi">0</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="n">x</span> <span class="mi">0</span>
<span class="mi">2</span>  <span class="mi">0</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="n">x</span> <span class="mi">0</span>
<span class="mi">2</span>  <span class="mi">0</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="n">x</span> <span class="mi">0</span>
<span class="o">-</span><span class="mi">3</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span> <span class="n">x</span>
<span class="o">-</span><span class="mi">5</span> <span class="n">x</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span> <span class="mi">0</span>
<span class="o">-</span><span class="mi">6</span> <span class="mi">0</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">7</span>  <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>  <span class="n">x</span>  <span class="mi">0</span>  <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
<p><a class="reference external" href="https://stackoverflow.com/questions/65862611/integration-of-sin-x-dx-problem-in-python-programming-implementation">https://stackoverflow.com/questions/65862611/integration-of-sin-x-dx-problem-in-python-programming-implementation</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
</pre></div>
</div>
</div>
</div>
<p>B)</p>
<ol class="simple">
<li><p>Usando su número de cédula cómo semilla, obtenga un numero entero aleatorio, <span class="math notranslate nohighlight">\(n\)</span>, entre 2 y 20.</p></li>
<li><p>Haga una estimación de la siguiente integral hasta dos cifras significativas, usando el método <code class="docutils literal notranslate"><span class="pre">quad</span></code> del módulo <code class="docutils literal notranslate"><span class="pre">integrate</span></code> de Scipy
$<span class="math notranslate nohighlight">\(
\int_0^\infty \sin(x^n)\operatorname{d}x
\)</span>$
Sugerencia. Compare con el valor obtenido desde <a class="reference external" href="https://www.wolframalpha.com/">https://www.wolframalpha.com/</a> o <a class="reference external" href="https://stackoverflow.com/questions/65862611/integration-of-sin-x-dx-problem-in-python-programming-implementation">sympy</a></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">20</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="n">limit</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.07637757819316301, 1.3763485142485971e-08)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">A</span><span class="o">=</span><span class="p">(</span><span class="n">A</span><span class="o">+</span><span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span>
<span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">:]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="c1">#A[1:4,0]=0; A[1:4,2:6]=0;A[1:4,7]=0</span>
<span class="c1">#A[1:4,0]=0; A[1:4,2:6]=0;A[1:4,7]=0</span>
<span class="n">A</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">A</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">A</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">A</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">:]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">A</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">A</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">:]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.    0.    0.    0.    0.    0.5   0.    0.   ]
 [0.    0.91  0.485 0.385 0.    0.    0.345 0.   ]
 [0.    0.485 0.58  0.83  0.    0.    0.79  0.   ]
 [0.    0.385 0.83  0.73  0.    0.    0.375 0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.405]
 [0.5   0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.345 0.79  0.375 0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.405 0.    0.    0.   ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.0009152155976835935
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.5       , -0.5       ,  2.22941876, -0.58499967,  0.03145016,
         0.54413075, -0.405     ,  0.405     ]),
 array([[ 7.07106781e-01,  7.07106781e-01,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00],
        [ 0.00000000e+00,  0.00000000e+00,  4.71573529e-01,
          1.52191361e-02, -1.29864533e-01, -8.72079118e-01,
          2.32562043e-17, -1.25467345e-16],
        [ 0.00000000e+00,  0.00000000e+00,  5.88982890e-01,
          6.37530946e-01,  4.18584679e-01,  2.67283211e-01,
         -7.05326718e-17,  5.17793473e-18],
        [ 0.00000000e+00,  0.00000000e+00,  5.40291135e-01,
         -1.94294611e-01, -7.16866962e-01,  3.95520988e-01,
         -2.08980837e-17,  8.69244289e-17],
        [ 0.00000000e+00,  0.00000000e+00, -3.61278584e-18,
          3.64124750e-17,  1.77205010e-17,  2.06816699e-16,
         -7.07106781e-01, -7.07106781e-01],
        [ 7.07106781e-01, -7.07106781e-01,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00],
        [ 0.00000000e+00,  0.00000000e+00,  3.72562814e-01,
         -7.45367208e-01,  5.42239642e-01,  1.07707221e-01,
          9.56213064e-17, -1.54452559e-17],
        [ 0.00000000e+00,  0.00000000e+00, -8.04028896e-19,
         -2.79765005e-17,  7.06100431e-18,  1.68187452e-16,
          7.07106781e-01, -7.07106781e-01]]))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_hidden_sector</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 52s, sys: 31.4 ms, total: 1min 52s
Wall time: 1min 52s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span><span class="o">==</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>l</th>
      <th>k</th>
      <th>solution</th>
      <th>gcd</th>
      <th>n</th>
      <th>zmax</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[-2]</td>
      <td>[2, 3]</td>
      <td>[1, 5, -7, -8, 9]</td>
      <td>4</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[3]</td>
      <td>[-3, -2]</td>
      <td>[2, 4, -7, -9, 10]</td>
      <td>18</td>
      <td>5</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[-2]</td>
      <td>[3, 1]</td>
      <td>[1, 14, -17, -18, 20]</td>
      <td>6</td>
      <td>5</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[-4, -2]</td>
      <td>[5, 2]</td>
      <td>[1, 1, 1, -4, -4, 5]</td>
      <td>40</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[2, 3]</td>
      <td>[-1, -3]</td>
      <td>[1, -2, -3, 5, 5, -6]</td>
      <td>1</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>96148</th>
      <td>[-7, 2, 1, 0, 6]</td>
      <td>[-20, -15, -16, -17, 17]</td>
      <td>[1, -7, -8, -11, 13, 17, 17, 17, 17, -18, -18,...</td>
      <td>120</td>
      <td>12</td>
      <td>20</td>
    </tr>
    <tr>
      <th>96149</th>
      <td>[-14, 8, -18, -12, -8]</td>
      <td>[-20, 6, 2, 3, 7]</td>
      <td>[2, 2, 9, 11, 11, -12, -13, -13, -13, 14, -18,...</td>
      <td>6188</td>
      <td>12</td>
      <td>20</td>
    </tr>
    <tr>
      <th>96150</th>
      <td>[-12, 0, 6, -18, 6]</td>
      <td>[19, -1, -20, -10, 16]</td>
      <td>[1, -3, -9, -12, 13, 13, 13, -17, -17, 19, 19,...</td>
      <td>5760</td>
      <td>12</td>
      <td>20</td>
    </tr>
    <tr>
      <th>96151</th>
      <td>[-20, -3, 10, -13, -16]</td>
      <td>[19, 0, -5, -6, -3]</td>
      <td>[1, 3, 4, 4, -5, -8, -16, 19, 19, 19, -20, -20]</td>
      <td>1350</td>
      <td>12</td>
      <td>20</td>
    </tr>
    <tr>
      <th>96152</th>
      <td>[20, 6, 20, 6, 10]</td>
      <td>[-19, 10, -18, -11, 14]</td>
      <td>[1, -8, -8, -9, 13, 15, 15, -17, 19, 19, -20, ...</td>
      <td>10892</td>
      <td>12</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
<p>96153 rows × 6 columns</p>
</div></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="DevOps.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">GitHub Actions for DevOps</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Intro_clases.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Clases</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Diego Restrepo (UdeA)<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>